import{c as P,r as x,j as e,T as A}from"./index-BZJhhq9e.js";import{u as O}from"./useEvents-Bsixy3u3.js";import{u as se}from"./useStats-DrlZsxz4.js";import{C as ae}from"./ConfirmDialog-HVzABMDP.js";import{S as re}from"./search-BJE-DGk2.js";import{S as ne}from"./sparkles-B3B5ZR3r.js";import{P as W}from"./plus-b0t4L9Pd.js";import{C as le}from"./chevron-down-CYDrqRbc.js";import{T as ie}from"./trash-2-_y2wKQwV.js";import"./pace-Dbu3TRjw.js";const oe=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],ce=P("arrow-up-down",oe);const de=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],ue=P("arrow-up-right",de);const me=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],B=P("grip-vertical",me);function $(t,r,a){return Math.max(r,Math.min(a,t))}function xe(t){return!t||t<=20?8:t<=50?10:t<=100?12:t<=200?14:16}function he(t){const r=$(t??3,1,5);return r<=2?-1:r>=5?2:r>=4?1:0}function ge(t){return!t||t<=20?25:t<=50?40:t<=100?60:t<=200?80:100}function pe(t,r){const a=t>=12?2:1,n=t>=10?2:1,i=t-a-n,h=r>=4?.55:.45,c=Math.round(i*h);return{base:i-c,build:c,peak:n,taper:a}}function fe(t,r){const a=t==="Mountain",n=t==="Urban";return{base:a?"Include hill repeats 1x per week to build ascending strength":n?"Alternate between park trails and pavement to condition joints":"Focus on time-on-feet over speed; mix terrain types",build:a?"Add sustained climbs; practice descent technique on tired legs":n?"Long pavement sessions â€” train your feet for concrete impact":"Back-to-back long days to simulate event fatigue",peak:a?"Full-elevation dress rehearsal on similar terrain":n?"Full-distance city walk at target pace with race-day kit":"Event-simulation day: full kit, nutrition plan, target pace",taper:"Reduce volume 40-60%. Keep intensity with short sharp sessions. Rest is training."}[r]||""}const D={base:{name:"Base Phase",description:"Build your aerobic engine and movement habit. Consistent easy volume, no heroics."},build:{name:"Build Phase",description:"Increase distance and specificity. Train the demands your event will throw at you."},peak:{name:"Peak Phase",description:"Hit your highest training volume. Dress rehearsals and confidence-building sessions."},taper:{name:"Taper",description:"Reduce volume, maintain sharpness. Trust the work you've done. Arrive fresh."}};function ye(t,r,a,n){const i=[];let h=0;const c=[{key:"base",weeks:t.base},{key:"build",weeks:t.build},{key:"peak",weeks:t.peak},{key:"taper",weeks:t.taper}];for(const{key:u,weeks:f}of c)for(let o=0;o<f;o++){h++;const m=o/f;let g;switch(u){case"base":g=Math.round(r*(.3+.25*m));break;case"build":g=Math.round(r*(.55+.35*m)),(o+1)%3===0&&(g=Math.round(g*.7));break;case"peak":g=Math.round(r*(.9+.1*m));break;case"taper":g=Math.round(r*(.6-.3*m));break;default:g=Math.round(r*.5)}const v={base:o===0?"Easy walks 3x, establish rhythm":`Easy volume â€” ${3+Math.min(o,2)}x sessions`,build:(o+1)%3===0?"Deload week â€” recover and absorb":`Long day + ${2+Math.min(o,2)} shorter sessions`,peak:o===0?"Highest volume week â€” dress rehearsal":"Maintain peak load, fine-tune pacing",taper:o===0?"Reduce to 60% volume, keep legs ticking":"Light movement only â€” trust the training"},y=n&&u!=="taper"?` Include ${Math.round(n*(.2+.2*m))}m elevation gain.`:"";i.push({week:h,phase:D[u].name,focus:v[u],targetKm:g,notes:fe(a,u)+y})}return i}function be(t){const r=t.distance??0,a=$(t.difficulty??3,1,5),n=t.type||"Ultra",i=t.elevation??null,h=xe(r)+he(a),c=$(h,8,16),u=pe(c,a),f=[{...D.base,weeks:u.base},{...D.build,weeks:u.build},{...D.peak,weeks:u.peak},{...D.taper,weeks:u.taper}],o=ge(r),m=ye(u,o,n,i);return{totalWeeks:c,phases:f,weeklyPlan:m}}const R=[{key:"all",label:"All",icon:"ðŸ§­"},{key:"Mountains",label:"Mountains",icon:"â›°ï¸"},{key:"Endurance",label:"Endurance",icon:"ðŸ¥¾"},{key:"Multi-Day",label:"Multi-Day",icon:"ðŸ•ï¸"},{key:"Urban",label:"Urban",icon:"ðŸ™ï¸"},{key:"International",label:"International",icon:"ðŸŒ"},{key:"Running",label:"Running",icon:"ðŸƒ"},{key:"Extreme",label:"Extreme",icon:"ðŸ”¥"}],ke=[{key:"default",label:"Default"},{key:"distance-asc",label:"Distance â†‘"},{key:"distance-desc",label:"Distance â†“"},{key:"difficulty-asc",label:"Easiest first"},{key:"difficulty-desc",label:"Hardest first"},{key:"name",label:"A â†’ Z"}];function je({level:t}){return e.jsx("div",{className:"flex gap-0.5",children:[1,2,3,4,5].map(r=>e.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${r<=t?"bg-amber-400":"bg-gray-700"}`},r))})}function ve(t,r,a){const n=[],i=t.personalRecords?.longestDistance?.value||0,h=new Set(r.map(o=>o.type)),c=new Set(a.map(o=>o.name.toLowerCase()));if(i>0&&i<160){const o=i<=50?100:160,m=`${o}km Ultra Challenge`;c.has(m.toLowerCase())||n.push({name:m,type:"Ultra",distance:o,reason:`You've conquered ${i}km â€” the next frontier is ${o}km`})}return!h.has("Urban")&&!c.has("urban endurance walk")&&n.push({name:"Urban Endurance Walk",type:"Urban",distance:50,reason:"You haven't done an urban challenge yet â€” try the concrete jungle"}),!h.has("Mountain")&&!c.has("mountain summit challenge")&&n.push({name:"Mountain Summit Challenge",type:"Mountain",distance:30,reason:"No mountain events yet â€” time to go vertical"}),!r.some(o=>o.location&&!["uk","england","scotland","wales","london","yorkshire","lake district","south downs","brighton","fort william"].some(m=>o.location.toLowerCase().includes(m)))&&!c.has("international ultra")&&n.push({name:"International Ultra",type:"Ultra",distance:100,reason:"All your events are UK-based â€” take it abroad"}),!r.some(o=>o.distance&&o.distance>=160)&&i>=100&&!c.has("multi-day stage race")&&n.push({name:"Multi-Day Stage Race",type:"Ultra",distance:200,reason:"You've done 100km in one go â€” try spreading it over multiple days"}),n.slice(0,3)}function we(t){const r={};for(const a of t){const n=a.category||"Custom";r[n]||(r[n]=[]),r[n].push(a)}return r}function Ne(t,r){if(r==="default")return t;const a=[...t];switch(r){case"distance-asc":return a.sort((n,i)=>(n.distance||0)-(i.distance||0));case"distance-desc":return a.sort((n,i)=>(i.distance||0)-(n.distance||0));case"difficulty-asc":return a.sort((n,i)=>(n.difficulty||0)-(i.difficulty||0));case"difficulty-desc":return a.sort((n,i)=>(i.difficulty||0)-(n.difficulty||0));case"name":return a.sort((n,i)=>n.name.localeCompare(i.name));default:return t}}function _({event:t,expanded:r,onToggle:a,onPromote:n,onEdit:i,onDelete:h,reorderMode:c,isOver:u,dragHandleProps:f}){return e.jsxs("div",{className:`bg-gray-800/60 rounded-2xl overflow-hidden border transition-colors ${c&&u?"border-t-2 border-t-indigo-500 border-gray-700/50":"border-gray-700/50"}`,children:[e.jsx("div",{className:c?"w-full text-left":void 0,children:c?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{...f,className:"flex items-center justify-center w-10 h-24 cursor-grab active:cursor-grabbing flex-shrink-0",children:e.jsx(B,{size:18,className:"text-gray-500"})}),e.jsx("div",{className:"w-16 h-24 flex items-center justify-center text-3xl flex-shrink-0",style:{background:t.heroImage},children:t.badge}),e.jsx("div",{className:"p-3.5 flex-1 min-w-0",children:e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-white font-bold text-base truncate",children:t.name}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400 mt-0.5",children:[e.jsx("span",{style:{color:A[t.type]},children:t.type}),t.distance&&e.jsxs("span",{children:[t.distance,"km"]})]})]})})]}):e.jsx("button",{onClick:a,className:"w-full text-left",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-20 h-24 flex items-center justify-center text-3xl flex-shrink-0",style:{background:t.heroImage},children:t.badge}),e.jsx("div",{className:"p-3.5 flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-white font-bold text-base truncate",children:t.name}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400 mt-0.5",children:[e.jsx("span",{style:{color:A[t.type]},children:t.type}),t.distance&&e.jsxs("span",{children:[t.distance,"km"]}),t.elevation&&e.jsxs("span",{children:["â†‘",t.elevation,"m"]})]}),e.jsx("div",{className:"mt-1",children:e.jsx(je,{level:t.difficulty||0})})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[t.targetYear&&e.jsx("span",{className:"bg-indigo-500/15 text-indigo-300 text-[10px] font-bold px-2 py-0.5 rounded",children:t.targetYear}),e.jsx(le,{size:16,className:`text-gray-500 transition-transform ${r?"rotate-180":""}`})]})]})})]})})}),!c&&r&&e.jsxs("div",{className:"border-t border-gray-700/50 p-4 space-y-3",children:[t.appeal&&e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] uppercase tracking-widest text-emerald-400 font-bold mb-1",children:"Why this appeals"}),e.jsx("p",{className:"text-gray-300 text-sm",children:t.appeal})]}),t.location&&e.jsxs("div",{className:"text-gray-400 text-sm",children:["ðŸ“ ",t.location]}),e.jsxs("div",{className:"flex gap-2 pt-1",children:[e.jsxs("button",{onClick:n,className:"flex-1 flex items-center justify-center gap-1.5 bg-emerald-600/20 border border-emerald-600/40 text-emerald-400 font-medium text-xs py-2.5 rounded-xl hover:bg-emerald-600/30 transition-colors",children:[e.jsx(ue,{size:14})," Make Next Target"]}),e.jsx("button",{onClick:i,className:"px-4 bg-gray-700/50 border border-gray-600/50 text-gray-300 text-xs py-2.5 rounded-xl hover:bg-gray-700 transition-colors",children:"Edit"}),e.jsx("button",{onClick:h,className:"px-3 bg-gray-700/50 border border-gray-600/50 text-gray-400 text-xs py-2.5 rounded-xl hover:text-red-400 hover:border-red-700/50 transition-colors",children:e.jsx(ie,{size:14})})]})]})]})}function Le({onAddWishlist:t,onEditEvent:r}){const{wishlist:a,upcoming:n,updateEvent:i,deleteEvent:h,reorderWishlist:c}=O(),u=se(),{completed:f}=O(),[o,m]=x.useState(null),[g,v]=x.useState(null),[y,Y]=x.useState("all"),[b,F]=x.useState(""),[w,H]=x.useState("default"),[I,L]=x.useState(!1),[p,q]=x.useState(!1),[k,N]=x.useState(null),[G,j]=x.useState(null),Q=x.useCallback(()=>{q(s=>(s||m(null),!s)),N(null),j(null)},[]),V=x.useCallback((s,l)=>{N(l),s.dataTransfer.effectAllowed="move"},[]),Z=x.useCallback((s,l)=>{s.preventDefault(),s.dataTransfer.dropEffect="move",j(l)},[]),J=x.useCallback(()=>{j(null)},[]),X=x.useCallback((s,l)=>{if(s.preventDefault(),k==null||k===l){N(null),j(null);return}const d=[...a],[T]=d.splice(k,1);d.splice(l,0,T),c(d.map(te=>te.id)),N(null),j(null)},[k,a,c]),K=x.useCallback(()=>{N(null),j(null)},[]),M=ve(u,f,a),ee=s=>{n&&i(n.id,{status:"wishlist",trainingPlan:null});const l=be(s);i(s.id,{status:"upcoming",trainingWeeks:Array(l.totalWeeks).fill(null),trainingPlan:l,phase:l.phases[0].name,week:`Week 1 of ${l.totalWeeks}`,progress:0})},S={};for(const s of a){const l=s.category||"Custom";S[l]=(S[l]||0)+1}const C=x.useMemo(()=>{let s=y==="all"?a:a.filter(l=>(l.category||"Custom")===y);if(b.trim()){const l=b.toLowerCase();s=s.filter(d=>d.name.toLowerCase().includes(l)||d.location&&d.location.toLowerCase().includes(l)||d.category&&d.category.toLowerCase().includes(l))}return Ne(s,w)},[a,y,b,w]),E=y==="all"&&!b.trim()&&w==="default"?we(C):null,U=R.map(s=>s.key).filter(s=>s!=="all");if(U.push("Custom"),a.length===0&&M.length===0)return e.jsxs("div",{className:"px-4 pb-24 sm:pb-8 pt-16 text-center",children:[e.jsx("div",{className:"text-5xl mb-4",children:"ðŸ§­"}),e.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:"What's on your horizon?"}),e.jsx("p",{className:"text-gray-400 text-sm mb-6 max-w-xs mx-auto",children:"Add the challenges you dream about. The ones that keep you training when it's dark and cold."}),e.jsx("button",{onClick:t,className:"bg-indigo-600 hover:bg-indigo-500 text-white font-bold text-sm px-6 py-3 rounded-xl transition-colors",children:"Add your first dream challenge"})]});const z=s=>e.jsx(_,{event:s,expanded:o===s.id,onToggle:()=>m(o===s.id?null:s.id),onPromote:()=>ee(s),onEdit:()=>r(s.id),onDelete:()=>v(s),reorderMode:!1},s.id);return e.jsxs("div",{className:"px-4 pb-24 sm:pb-8 pt-4 relative",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-2xl font-black text-white mb-1",children:"Bucket List"}),e.jsxs("p",{className:"text-gray-500 text-sm",children:[a.length," challenge",a.length!==1?"s":""," on the horizon"]})]}),e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(re,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500"}),e.jsx("input",{type:"text",value:p?"":b,onChange:s=>F(s.target.value),placeholder:p?"Reordering...":"Search challenges...",disabled:p,className:`w-full bg-gray-800/60 border border-gray-700/50 rounded-xl pl-8 pr-3 py-2 text-sm text-white placeholder-gray-500 focus:outline-none focus:border-indigo-500 transition-colors ${p?"opacity-50 cursor-not-allowed":""}`})]}),e.jsxs("button",{onClick:Q,className:`flex items-center gap-1.5 px-3 py-2 rounded-xl text-xs font-medium transition-all ${p?"bg-indigo-600 text-white":"bg-gray-800/60 text-gray-400 border border-gray-700/50 hover:border-gray-600"}`,children:[e.jsx(B,{size:14}),"Reorder"]}),!p&&e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>L(!I),className:`flex items-center gap-1.5 px-3 py-2 rounded-xl text-xs font-medium transition-all ${w!=="default"?"bg-indigo-600 text-white":"bg-gray-800/60 text-gray-400 border border-gray-700/50 hover:border-gray-600"}`,children:[e.jsx(ce,{size:14}),"Sort"]}),I&&e.jsx("div",{className:"absolute right-0 top-full mt-1 bg-gray-800 border border-gray-700 rounded-xl overflow-hidden shadow-xl z-50 min-w-[160px]",children:ke.map(s=>e.jsx("button",{onClick:()=>{H(s.key),L(!1)},className:`w-full text-left px-3 py-2 text-xs transition-colors ${w===s.key?"bg-indigo-600/20 text-indigo-300":"text-gray-300 hover:bg-gray-700"}`,children:s.label},s.key))})]})]}),e.jsx("div",{className:`flex gap-2 overflow-x-auto pb-3 mb-4 -mx-4 px-4 scrollbar-hide ${p?"opacity-50 pointer-events-none":""}`,children:R.map(s=>{const l=s.key==="all"?a.length:S[s.key]||0;if(s.key!=="all"&&l===0)return null;const d=y===s.key;return e.jsxs("button",{onClick:()=>Y(s.key),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-medium whitespace-nowrap transition-all flex-shrink-0 ${d?"bg-indigo-600 text-white shadow-lg shadow-indigo-600/25":"bg-gray-800/60 text-gray-400 border border-gray-700/50 hover:border-gray-600"}`,children:[e.jsx("span",{children:s.icon}),e.jsx("span",{children:s.label}),e.jsx("span",{className:`text-[10px] ${d?"text-indigo-200":"text-gray-600"}`,children:l})]},s.key)})}),p&&e.jsxs("div",{className:"space-y-2 mb-6",children:[e.jsx("div",{className:"text-gray-500 text-xs mb-3",children:'Drag to reorder your bucket list. Tap "Reorder" again when done.'}),a.map((s,l)=>e.jsx("div",{draggable:!0,onDragStart:d=>V(d,l),onDragOver:d=>Z(d,l),onDragLeave:J,onDrop:d=>X(d,l),onDragEnd:K,className:`transition-all ${k===l?"opacity-40":"opacity-100"}`,children:e.jsx(_,{event:s,expanded:!1,onToggle:()=>{},onPromote:()=>{},onEdit:()=>{},onDelete:()=>{},reorderMode:!0,isOver:G===l&&k!==l,dragHandleProps:{}})},s.id))]}),!p&&b.trim()&&e.jsxs("div",{className:"text-gray-500 text-xs mb-3",children:[C.length," result",C.length!==1?"s":"",' for "',b,'"']}),!p&&E&&e.jsx("div",{className:"space-y-6 mb-6",children:U.map(s=>{const l=E[s];if(!l?.length)return null;const d=R.find(T=>T.key===s);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("span",{className:"text-base",children:d?.icon||"ðŸ“Œ"}),e.jsx("h3",{className:"text-white font-bold text-sm",children:d?.label||s}),e.jsx("span",{className:"text-gray-600 text-xs",children:l.length})]}),e.jsx("div",{className:"space-y-3",children:l.map(z)})]},s)})}),!p&&!E&&e.jsx("div",{className:"space-y-3 mb-6",children:C.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-3xl mb-2",children:"ðŸ”"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"No challenges match your search"})]}):C.map(z)}),!p&&M.length>0&&y==="all"&&!b.trim()&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(ne,{size:16,className:"text-amber-400"}),e.jsx("h3",{className:"text-white font-bold text-sm",children:"Suggested Challenges"})]}),e.jsx("div",{className:"space-y-2",children:M.map((s,l)=>e.jsx("button",{onClick:()=>t(s),className:"w-full text-left bg-gray-800/30 border border-dashed border-gray-700/50 rounded-xl p-3.5 hover:border-amber-600/40 hover:bg-amber-900/10 transition-all group",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium text-sm group-hover:text-amber-200 transition-colors",children:s.name}),e.jsx("div",{className:"text-gray-500 text-xs mt-0.5",children:s.reason})]}),e.jsx(W,{size:16,className:"text-gray-600 group-hover:text-amber-400 transition-colors flex-shrink-0"})]})},l))})]}),e.jsx("button",{onClick:()=>t(),className:"fixed bottom-20 sm:bottom-6 right-4 sm:right-auto sm:left-1/2 sm:translate-x-[calc(min(50vw,320px)-2rem)] z-40 w-14 h-14 bg-indigo-600 hover:bg-indigo-500 text-white rounded-full shadow-lg shadow-indigo-600/30 flex items-center justify-center transition-all active:scale-90",children:e.jsx(W,{size:24,strokeWidth:2.5})}),g&&e.jsx(ae,{title:`Remove ${g.name}?`,message:"This will remove it from your bucket list.",onConfirm:()=>{h(g.id),v(null),m(null)},onCancel:()=>v(null)})]})}export{Le as default};
