import{c as w,j as e,r as g,u as I,h as Ce,T as le,a as Se,A as Ee,g as Re,b as Te,C as Me}from"./index-BZJhhq9e.js";import{d as B,F as De,c as ae}from"./countdown-C2B7DZG9.js";import{u as V}from"./useEvents-Bsixy3u3.js";import{u as ie}from"./useStats-DrlZsxz4.js";import{u as Ae}from"./useMilestones-CT3npQGZ.js";import{C as ze}from"./ConfirmDialog-HVzABMDP.js";import{X as O}from"./x-ITkdU1G8.js";import{D as q,C as oe,S as $e}from"./share-2-CWuFAdaM.js";import{c as Y,g as Le,h as ce,a as Pe}from"./streaks-DGNCr_2k.js";import{S as H}from"./sparkles-B3B5ZR3r.js";import{T as _e}from"./trash-2-_y2wKQwV.js";import{P as Ue}from"./plus-b0t4L9Pd.js";import{C as de}from"./calendar-CtwugMWp.js";import{C as Fe}from"./check-BSfdu-Z-.js";import{T as Ie}from"./triangle-alert-C4sIxLlw.js";import{C as Oe}from"./camera-BCuUa0ad.js";import{R as We}from"./route-C0xnRAcT.js";import{T as Ge}from"./trending-up-CB0BYqnY.js";import{R as Be,A as He,X as Ve,Y as qe,T as Ye,a as Je}from"./AreaChart-DZun_klY.js";import{C as Ke}from"./calculator-pXrvtay4.js";import{M as Xe}from"./map-BEWyWSer.js";import{U as Ze}from"./upload-Dvf45I3O.js";import"./pace-Dbu3TRjw.js";const Qe=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],et=w("activity",Qe);const tt=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],_=w("arrow-right",tt);const st=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],me=w("circle-check-big",st);const at=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],nt=w("file-down",at);const rt=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],lt=w("file-spreadsheet",rt);const it=[["path",{d:"M4 16v-2.38C4 11.5 2.97 10.5 3 8c.03-2.72 1.49-6 4.5-6C9.37 2 10 3.8 10 5.5c0 3.11-2 5.66-2 8.68V16a2 2 0 1 1-4 0Z",key:"1dudjm"}],["path",{d:"M20 20v-2.38c0-2.12 1.03-3.12 1-5.62-.03-2.72-1.49-6-4.5-6C14.63 6 14 7.8 14 9.5c0 3.11 2 5.66 2 8.68V20a2 2 0 1 0 4 0Z",key:"l2t8xc"}],["path",{d:"M16 17h4",key:"1dejxt"}],["path",{d:"M4 13h4",key:"1bwh8b"}]],ot=w("footprints",it);const ct=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],dt=w("heart",ct);const mt=[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]],xe=w("instagram",mt);const xt=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],ht=w("moon",xt);const ft=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],ut=w("palette",ft);const pt=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],gt=w("pause",pt);const bt=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],yt=w("printer",bt);const vt=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],jt=w("rotate-ccw",vt);const wt=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],kt=w("settings",wt);const Nt=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],Ct=w("sun",Nt);const St=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],he=w("user",St);function Et(s){const n={exportVersion:1,exportedAt:new Date().toISOString(),events:s.events,milestones:s.milestones,radarData:s.radarData,preferences:s.preferences},t=new Blob([JSON.stringify(n,null,2)],{type:"application/json"}),l=URL.createObjectURL(t),o=document.createElement("a");o.href=l,o.download=`achievement-wall-${new Date().toISOString().slice(0,10)}.json`,o.click(),URL.revokeObjectURL(l)}function Rt(s){return new Promise((n,t)=>{const l=new FileReader;l.onload=o=>{try{const i=JSON.parse(o.target.result);if(!i.events||!Array.isArray(i.events)){t(new Error("Invalid file: missing events array"));return}n({events:i.events,milestones:i.milestones||[],radarData:i.radarData||[],preferences:i.preferences||{}})}catch{t(new Error("Invalid JSON file"))}},l.onerror=()=>t(new Error("Failed to read file")),l.readAsText(s)})}function G({value:s,target:n,label:t,unit:l,color:o}){const i=n>0?Math.min(s/n,1):0,d=36,r=2*Math.PI*d,a=r*(1-i);return e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("svg",{width:"88",height:"88",viewBox:"0 0 88 88",children:[e.jsx("circle",{cx:"44",cy:"44",r:d,fill:"none",stroke:"#1f2937",strokeWidth:"6"}),e.jsx("circle",{cx:"44",cy:"44",r:d,fill:"none",stroke:o,strokeWidth:"6",strokeLinecap:"round",strokeDasharray:r,strokeDashoffset:a,transform:"rotate(-90 44 44)",className:"transition-all duration-700"}),e.jsxs("text",{x:"44",y:"40",textAnchor:"middle",fill:"white",fontSize:"14",fontWeight:"800",children:[Math.round(i*100),"%"]}),e.jsxs("text",{x:"44",y:"54",textAnchor:"middle",fill:"#9ca3af",fontSize:"9",children:[s,"/",n,l]})]}),e.jsx("span",{className:"text-[10px] text-gray-400 uppercase tracking-wider mt-1 font-medium",children:t})]})}function Tt({totalEvents:s,totalDistance:n,totalElevation:t,topEvents:l,badgesCount:o}){const r=document.createElement("canvas");r.width=900,r.height=1200;const a=r.getContext("2d"),f=a.createLinearGradient(0,0,900,1200);f.addColorStop(0,"#0f172a"),f.addColorStop(.5,"#1e1b4b"),f.addColorStop(1,"#0f172a"),a.fillStyle=f,a.fillRect(0,0,900,1200),a.globalAlpha=.08;const c=a.createRadialGradient(180,600,0,180,600,400);c.addColorStop(0,"#8b5cf6"),c.addColorStop(1,"transparent"),a.fillStyle=c,a.fillRect(0,0,900,1200);const m=a.createRadialGradient(720,600,0,720,600,400);m.addColorStop(0,"#ef4444"),m.addColorStop(1,"transparent"),a.fillStyle=m,a.fillRect(0,0,900,1200),a.globalAlpha=1,a.textAlign="center",a.fillStyle="#ffffff",a.font="bold 56px system-ui, -apple-system, sans-serif",a.fillText("JOE'S ENDURANCE CV",900/2,120),a.fillStyle="#6b7280",a.font="16px system-ui, -apple-system, sans-serif",a.fillText("Every kilometre earned. Every peak conquered.",900/2,160);const x=a.createLinearGradient(200,0,700,0);x.addColorStop(0,"transparent"),x.addColorStop(.5,"#374151"),x.addColorStop(1,"transparent"),a.fillStyle=x,a.fillRect(200,190,500,1);const h=[{val:`${s}`,label:"EVENTS",color:"#f59e0b"},{val:`${n}km`,label:"DISTANCE",color:"#10b981"},{val:`${(t/1e3).toFixed(1)}k m`,label:"ELEVATION",color:"#8b5cf6"},{val:`${o}`,label:"BADGES",color:"#ef4444"}],y=170,b=120,p=25,k=(900-(y*4+p*3))/2,v=230;h.forEach((N,M)=>{const S=k+M*(y+p);a.fillStyle="rgba(255,255,255,0.05)",U(a,S,v,y,b,16),a.fill(),a.strokeStyle="rgba(255,255,255,0.1)",a.lineWidth=1,U(a,S,v,y,b,16),a.stroke(),a.fillStyle="#ffffff",a.font="bold 36px system-ui, -apple-system, sans-serif",a.textAlign="center",a.fillText(N.val,S+y/2,v+55),a.fillStyle=N.color,a.font="bold 11px system-ui, -apple-system, sans-serif",a.letterSpacing="2px",a.fillText(N.label,S+y/2,v+85),a.letterSpacing="0px"}),a.fillStyle="#6b7280",a.font="bold 12px system-ui, -apple-system, sans-serif",a.textAlign="left",a.fillText("TOP CHALLENGES",80,420),l.slice(0,5).forEach((N,M)=>{const S=450+M*100;a.fillStyle="rgba(255,255,255,0.03)",U(a,60,S,780,80,16),a.fill(),a.strokeStyle="rgba(255,255,255,0.06)",U(a,60,S,780,80,16),a.stroke(),a.font="32px system-ui, -apple-system, sans-serif",a.textAlign="center",a.fillText(N.badge||"üèÜ",110,S+52),a.fillStyle="#ffffff",a.font="bold 22px system-ui, -apple-system, sans-serif",a.textAlign="left",a.fillText(N.name,155,S+38),a.fillStyle="#9ca3af",a.font="14px system-ui, -apple-system, sans-serif";const J=[N.type,N.distance?`${N.distance}km`:null,N.location].filter(Boolean).join(" ¬∑ ");a.fillText(J,155,S+62)});const L=1140;return a.fillStyle="#374151",a.fillRect(200,L-30,500,1),a.fillStyle="#4b5563",a.font="14px system-ui, -apple-system, sans-serif",a.textAlign="center",a.fillText("Built with grit, tracked with code",900/2,L),r}function U(s,n,t,l,o,i){s.beginPath(),s.moveTo(n+i,t),s.lineTo(n+l-i,t),s.quadraticCurveTo(n+l,t,n+l,t+i),s.lineTo(n+l,t+o-i),s.quadraticCurveTo(n+l,t+o,n+l-i,t+o),s.lineTo(n+i,t+o),s.quadraticCurveTo(n,t+o,n,t+o-i),s.lineTo(n,t+i),s.quadraticCurveTo(n,t,n+i,t),s.closePath()}function ne(s){s.toBlob(n=>{const t=URL.createObjectURL(n),l=document.createElement("a");l.href=t,l.download="endurance-cv.png",l.click(),URL.revokeObjectURL(t)},"image/png")}async function Mt(s){const n=await new Promise(t=>s.toBlob(t,"image/png"));await navigator.clipboard.write([new ClipboardItem({"image/png":n})])}function Dt({stats:s,onClose:n}){const t=g.useRef(null),[l,o]=g.useState(!1);g.useEffect(()=>{const d=Tt(s);t.current=d},[s]);const i=async()=>{try{await Mt(t.current),o(!0),setTimeout(()=>o(!1),2e3)}catch{ne(t.current)}};return e.jsx("div",{className:"fixed inset-0 z-50 bg-black/90 flex flex-col items-center justify-center p-4",onClick:n,children:e.jsxs("div",{className:"relative max-w-sm w-full",onClick:d=>d.stopPropagation(),children:[e.jsx("button",{onClick:n,className:"absolute -top-10 right-0 text-white/70 hover:text-white",children:e.jsx(O,{size:24})}),e.jsx("canvas",{ref:d=>{d&&t.current&&d.getContext("2d").drawImage(t.current,0,0,d.width,d.height)},width:450,height:600,className:"w-full rounded-xl shadow-2xl"}),e.jsxs("div",{className:"flex gap-3 mt-4",children:[e.jsxs("button",{onClick:()=>ne(t.current),className:"flex-1 flex items-center justify-center gap-2 bg-indigo-600 hover:bg-indigo-500 text-white font-medium py-3 rounded-xl transition-colors",children:[e.jsx(q,{size:18})," Download PNG"]}),e.jsxs("button",{onClick:i,className:"flex-1 flex items-center justify-center gap-2 bg-gray-800 hover:bg-gray-700 text-white font-medium py-3 rounded-xl border border-gray-700 transition-colors",children:[e.jsx(oe,{size:18})," ",l?"Copied!":"Copy"]})]})]})})}function At(s){if(!s||s.length===0)return null;const n=new Date,t=new Date(n.getFullYear(),0,0),l=Math.floor((n-t)/(1e3*60*60*24)),o=n.getFullYear()*366+l;return s[o%s.length]}function zt(s,n,t){return s!==null&&s>=0&&s<=7?s===0?`Today is the day. Go crush ${n}.`:s===1?`Tomorrow you face ${n}. You're ready.`:`${s} days until ${n}. Trust your training.`:t>4?`${t} weeks consistent. You're building something unbreakable.`:null}function $t(){const{state:s,dispatch:n}=I(),{upcoming:t}=V(),[l,o]=g.useState(!1),[i,d]=g.useState(""),r=s.preferences?.mantras??[],a=At(r),f=s.preferences?.weeklyCheckins??[],{current:c}=Y(f),m=t?.date?B(t.date):null,x=zt(m,t?.name,c),h=()=>{const b=i.trim();b&&(n({type:"UPDATE_PREFERENCES",payload:{mantras:[...r,b]}}),d(""))},y=b=>{n({type:"UPDATE_PREFERENCES",payload:{mantras:r.filter((p,k)=>k!==b)}})};return!a&&!x?null:e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>o(!0),className:"w-full bg-gray-800/60 rounded-2xl p-5 border border-gray-700/50 text-center hover:border-gray-600 transition-all active:scale-[0.99]",children:[x&&e.jsx("div",{className:"text-amber-400 text-xs font-bold mb-2",children:x}),a&&e.jsxs("p",{className:"text-gray-200 text-sm italic leading-relaxed",children:["‚Äú",a,"‚Äù"]}),e.jsxs("div",{className:"text-gray-600 text-[10px] mt-2 flex items-center justify-center gap-1",children:[e.jsx(H,{size:10})," Tap for all mantras"]})]}),l&&e.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-end sm:items-center justify-center",onClick:()=>o(!1),children:e.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-t-2xl sm:rounded-2xl w-full max-w-md max-h-[80vh] overflow-y-auto",onClick:b=>b.stopPropagation(),children:[e.jsxs("div",{className:"sticky top-0 bg-gray-900 border-b border-gray-800 p-4 flex items-center justify-between z-10",children:[e.jsx("h3",{className:"text-white font-bold",children:"Your Mantras"}),e.jsx("button",{onClick:()=>o(!1),className:"text-gray-500 hover:text-white transition-colors",children:e.jsx(O,{size:18})})]}),e.jsxs("div",{className:"p-4 space-y-2",children:[r.map((b,p)=>e.jsxs("div",{className:"flex items-start gap-3 bg-gray-800/60 rounded-xl p-3 border border-gray-700/30 group",children:[e.jsx(H,{size:14,className:"text-amber-400 flex-shrink-0 mt-0.5"}),e.jsxs("span",{className:"text-gray-300 text-sm flex-1 italic",children:["‚Äú",b,"‚Äù"]}),e.jsx("button",{onClick:()=>y(p),className:"text-gray-700 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0",children:e.jsx(_e,{size:14})})]},p)),r.length===0&&e.jsx("p",{className:"text-gray-500 text-sm text-center py-4",children:"No mantras yet. Add one below."})]}),e.jsx("div",{className:"sticky bottom-0 bg-gray-900 border-t border-gray-800 p-4 z-10",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:i,onChange:b=>d(b.target.value),onKeyDown:b=>b.key==="Enter"&&h(),placeholder:"Add a mantra...",className:"flex-1 bg-gray-800 border border-gray-700 rounded-xl px-3 py-2.5 text-sm text-white placeholder-gray-500 focus:outline-none focus:border-indigo-500"}),e.jsx("button",{onClick:h,className:"bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl px-3 transition-colors",children:e.jsx(Ue,{size:18})})]})})]})})]})}const Lt=[{id:"ach-first-blood",name:"First Blood",icon:"ü©∏",description:"Complete your first event",check:s=>s.totalEvents>=1},{id:"ach-half-century",name:"Half Century",icon:"5Ô∏è‚É£",description:"Complete a 50km+ event in a single push",check:(s,n)=>n.some(t=>t.status==="completed"&&t.distance>=50)},{id:"ach-century-club",name:"Century Club",icon:"üíØ",description:"Complete a 100km+ event ‚Äî welcome to the club",check:(s,n)=>n.some(t=>t.status==="completed"&&t.distance>=100)},{id:"ach-peak-bagger",name:"Peak Bagger",icon:"‚õ∞Ô∏è",description:"Summit 5+ different peaks across all events",check:(s,n)=>{const t=new Set;for(const l of n)if(l.status==="completed"&&l.peaks)for(const o of l.peaks)t.add(o);return t.size>=5}},{id:"ach-type-collector",name:"Type Collector",icon:"üé®",description:"Complete events in all 3 types: Mountain, Ultra, Urban",check:(s,n)=>{const t=new Set(n.filter(l=>l.status==="completed").map(l=>l.type));return t.has("Mountain")&&t.has("Ultra")&&t.has("Urban")}},{id:"ach-streak-machine",name:"Streak Machine",icon:"üî•",description:"Build a 4+ week training streak",check:(s,n,t)=>{const l=t?.weeklyCheckins??[],{longest:o}=Y(l);return o>=4}},{id:"ach-repeat-offender",name:"Repeat Offender",icon:"üîÅ",description:"Complete the same event 3 or more times",check:(s,n)=>n.some(t=>t.status==="completed"&&(t.completions||1)>=3)},{id:"ach-high-roller",name:"High Roller",icon:"üé≤",description:"Complete a difficulty 5 event",check:(s,n)=>n.some(t=>t.status==="completed"&&t.difficulty===5)},{id:"ach-distance-king",name:"Distance King",icon:"üëë",description:"Accumulate 500km total distance",check:s=>s.totalDistance>=500},{id:"ach-elevation-master",name:"Elevation Master",icon:"üèîÔ∏è",description:"Accumulate 5,000m total elevation gain",check:s=>s.totalElevation>=5e3},{id:"ach-night-owl",name:"Night Owl",icon:"üåô",description:"Complete a 100km+ event (implies walking through the night)",check:(s,n)=>n.some(t=>t.status==="completed"&&t.distance>=100)},{id:"ach-bucket-lister",name:"Bucket Lister",icon:"üìã",description:"Promote 3+ wishlist challenges to upcoming or completed",check:(s,n)=>n.filter(l=>l.id.startsWith("wish-")&&(l.status==="upcoming"||l.status==="completed")).length>=3},{id:"chain-3-peaks",name:"Three Peaks Master",icon:"üèîÔ∏è",description:"Complete the Yorkshire, National, and Welsh 3 Peaks",check:(s,n)=>{const t=new Set(n.filter(l=>l.status==="completed").map(l=>l.id));return t.has("y3p-001")&&t.has("n3p-004")&&t.has("wish-w3pk0")}},{id:"chain-bg-trilogy",name:"Bob Graham Trilogy",icon:"üëë",description:"Complete the Bob Graham, Paddy Buckley, and Ramsay Rounds",check:(s,n)=>{const t=new Set(n.filter(l=>l.status==="completed").map(l=>l.id));return t.has("wish-bgr00")&&t.has("wish-paddy")&&t.has("wish-ramsy")}},{id:"chain-london-underground",name:"London Underground",icon:"üöá",description:"Complete 3 or more tube line walks",check:(s,n)=>{const t=["wish-piccl","wish-centl","wish-bakrl","wish-jubll","wish-nrthl","wish-victo","wish-distr","wish-metrl","wish-circl","wish-hammr"];return n.filter(o=>o.status==="completed"&&t.some(i=>o.id.startsWith(i))).length>=3}},{id:"chain-coast-to-coast",name:"Coast to Coast",icon:"üåä",description:"Complete Hadrian's Wall and the Coast to Coast Walk",check:(s,n)=>{const t=new Set(n.filter(l=>l.status==="completed").map(l=>l.id));return t.has("wish-hadri")&&t.has("wish-c2c00")}},{id:"chain-lake-district",name:"Lake District Legend",icon:"‚õ∞Ô∏è",description:"Summit Helvellyn, Great Gable, Skiddaw, and Blencathra",check:(s,n)=>{const t=new Set(n.filter(l=>l.status==="completed").map(l=>l.id));return t.has("wish-helve")&&t.has("wish-grgab")&&t.has("wish-skidd")&&t.has("wish-shrpe")}},{id:"chain-scottish-explorer",name:"Scottish Explorer",icon:"üè¥Û†ÅßÛ†Å¢Û†Å≥Û†Å£Û†Å¥Û†Åø",description:"Complete the West Highland Way, Rob Roy Way, and Speyside Way",check:(s,n)=>{const t=new Set(n.filter(l=>l.status==="completed").map(l=>l.id));return t.has("wish-whw00")&&t.has("wish-rroyw")&&t.has("wish-speyw")}}];function Pt(s,n,t){const l=new Set((t?.unlockedAchievements??[]).map(i=>i.id)),o=[];for(const i of Lt)if(!l.has(i.id))try{i.check(s,n,t)&&o.push({id:i.id,name:i.name,icon:i.icon,description:i.description,unlockedAt:new Date().toISOString()})}catch{}return o}function _t({onDone:s}){const n=g.useRef(null);return g.useEffect(()=>{const t=n.current;if(!t)return;const l=t.getContext("2d"),o=window.devicePixelRatio||1,i=t.clientWidth,d=t.clientHeight;t.width=i*o,t.height=d*o,l.scale(o,o);const r=["#f59e0b","#10b981","#8b5cf6","#ef4444","#ec4899","#06b6d4","#f97316","#84cc16"],a=Array.from({length:35},()=>({x:Math.random()*i,y:-10-Math.random()*40,vx:(Math.random()-.5)*3,vy:1.5+Math.random()*3,size:4+Math.random()*4,color:r[Math.floor(Math.random()*r.length)],rotation:Math.random()*Math.PI*2,rotSpeed:(Math.random()-.5)*.2,opacity:1})),f=performance.now(),c=2e3;let m;function x(h){const y=h-f,b=Math.min(y/c,1);l.clearRect(0,0,i,d);for(const p of a)p.x+=p.vx,p.vy+=.06,p.y+=p.vy,p.rotation+=p.rotSpeed,p.opacity=Math.max(0,1-b*1.2),l.save(),l.translate(p.x,p.y),l.rotate(p.rotation),l.globalAlpha=p.opacity,l.fillStyle=p.color,l.fillRect(-p.size/2,-p.size/2,p.size,p.size*.6),l.restore();b<1?m=requestAnimationFrame(x):s?.()}return m=requestAnimationFrame(x),()=>cancelAnimationFrame(m)},[s]),e.jsx("canvas",{ref:n,className:"absolute inset-0 pointer-events-none",style:{width:"100%",height:"100%"}})}function Ut({achievements:s,onDismiss:n}){const[t,l]=g.useState([]),[o,i]=g.useState(null),[d,r]=g.useState(!1),[a,f]=g.useState(!1),c=g.useRef(null);g.useEffect(()=>{s&&s.length>0&&l([...s])},[s]),g.useEffect(()=>{if(o||t.length===0)return;const[x,...h]=t;return i(x),l(h),f(!1),Ce(),requestAnimationFrame(()=>r(!0)),c.current=setTimeout(()=>{r(!1),setTimeout(()=>{i(null),h.length===0&&n?.()},350)},4e3),()=>clearTimeout(c.current)},[t,o,n]);const m=g.useCallback(()=>f(!0),[]);return o?e.jsx("div",{className:"fixed top-0 left-0 right-0 z-[200] flex justify-center pointer-events-none px-4 pt-4",children:e.jsxs("div",{className:`relative overflow-hidden bg-gray-900 border border-gray-700/60 rounded-2xl shadow-2xl shadow-black/40 max-w-sm w-full pointer-events-auto transition-all duration-350 ${d?"translate-y-0 opacity-100":"-translate-y-full opacity-0"}`,children:[!a&&e.jsx(_t,{onDone:m}),e.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-amber-500 via-emerald-400 to-indigo-500"}),e.jsxs("div",{className:"relative flex items-center gap-3 px-5 py-4",children:[e.jsx("div",{className:"text-4xl flex-shrink-0 animate-bounce",children:o.icon}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-[10px] uppercase tracking-widest text-amber-400 font-bold mb-0.5",children:"Achievement Unlocked"}),e.jsx("div",{className:"text-white font-bold text-sm truncate",children:o.name}),e.jsx("div",{className:"text-gray-400 text-xs mt-0.5 leading-snug",children:o.description})]})]})]})}):null}function fe({value:s,suffix:n="",decimals:t=0}){const[l,o]=g.useState(0),i=g.useRef(!1),d=g.useRef(null);g.useEffect(()=>{if(i.current)return;if(typeof s!="number"||s===0){o(s||0);return}i.current=!0;const a=1500,f=performance.now();function c(x){return x>=1?1:1-Math.pow(2,-10*x)}function m(x){const h=x-f,y=Math.min(h/a,1),b=c(y);o(b*s),y<1?d.current=requestAnimationFrame(m):o(s)}return d.current=requestAnimationFrame(m),()=>{d.current&&cancelAnimationFrame(d.current)}},[s]);const r=t>0?l.toFixed(t):Math.round(l).toLocaleString();return e.jsxs("span",{children:[r,n]})}function ue(){const s=Le(),n=new Date(s);return n.setDate(n.getDate()+6),{monday:s,sunday:n}}function re(s){return s.toLocaleDateString("en-US",{month:"short",day:"numeric"})}function Ft(s,n){const{monday:t,sunday:l}=ue(),o=t.getTime(),i=new Date(l);i.setHours(23,59,59,999);const d=i.getTime();let r=0,a=0,f=0;(s||[]).forEach(m=>{if(m.status!=="completed"||!m.date)return;const x=new Date(m.date).getTime();x>=o&&x<=d&&(f++,r+=m.distance||0,a+=m.elevation||0)});const c=ce(n);return{distance:r,elevation:a,eventCount:f,checkedIn:c}}function It({events:s,checkins:n}){const[t,l]=g.useState(!1),{monday:o,sunday:i}=ue(),{distance:d,elevation:r,eventCount:a,checkedIn:f}=Ft(s,n),c=`${re(o)} - ${re(i)}`,m=d>0||r>0||a>0,x=async()=>{const h=[`This Week (${c})`,`Distance: ${d}km`,`Elevation: ${r.toLocaleString()}m`,`Events: ${a}`,f?"Training check-in: Done":""].filter(Boolean);try{await navigator.clipboard.writeText(h.join(`
`)),l(!0),setTimeout(()=>l(!1),2e3)}catch{}};return e.jsxs("div",{className:"bg-gray-800/60 rounded-2xl p-5 border border-gray-700/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(de,{size:16,className:"text-indigo-400"}),e.jsx("h3",{className:"text-sm font-bold text-white",children:"This Week"}),e.jsx("span",{className:"text-gray-500 text-xs",children:c})]}),e.jsx("button",{onClick:x,className:"p-1.5 rounded-lg bg-white/5 text-gray-400 hover:text-white hover:bg-white/10 transition-colors",title:"Copy summary",children:t?e.jsx(Fe,{size:14,className:"text-emerald-400"}):e.jsx(oe,{size:14})})]}),m?e.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{value:d,suffix:"km",label:"Distance",color:"#10b981"},{value:r,suffix:"m",label:"Elevation",color:"#8b5cf6"},{value:a,suffix:"",label:"Events",color:"#f59e0b"}].map(h=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-black text-white",children:e.jsx(fe,{value:h.value,suffix:h.suffix})}),e.jsx("div",{className:"text-[10px] uppercase tracking-wider font-medium mt-0.5",style:{color:h.color},children:h.label})]},h.label))}):e.jsx("div",{className:"text-center py-3",children:e.jsx("p",{className:"text-gray-400 text-sm italic",children:"Fresh week ‚Äî what will you conquer?"})})]})}function Ot(s,n,t){const l=n.filter(a=>a.status==="completed"),o=Math.max(...l.map(a=>a.difficulty||0),0),i=new Date().toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"}),d=l.sort((a,f)=>(f.difficulty||0)-(a.difficulty||0)).map(a=>{const f=le[a.type]||"#6b7280",c=Array.from({length:5}).map((y,b)=>`<span style="display:inline-block;width:8px;height:8px;border-radius:50%;margin-right:2px;background:${b<(a.difficulty||0)?"#fbbf24":"#374151"}"></span>`).join(""),m=a.distance?`${a.distance}km`:"",x=a.elevation?`${a.elevation.toLocaleString()}m`:"",h=m&&x?" &middot; ":"";return`
        <div class="event-card">
          <div class="event-header">
            <span class="event-name">${F(a.name)}</span>
            <span class="type-badge" style="background:${f}20;color:${f}">${F(a.type)}</span>
          </div>
          <div class="event-meta">
            ${m||x?`<span class="event-metrics">${m}${h}${x}</span>`:""}
            <span class="event-dots">${c}</span>
          </div>
        </div>`}).join(`
`),r=(s.funFacts||[]).map(a=>`
        <div class="fun-fact">
          <span class="fun-fact-icon">${a.icon}</span>
          <span>${F(a.text)}</span>
        </div>`).join(`
`);return`<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Joe's Endurance CV - A shareable profile of endurance achievements">
  <meta name="theme-color" content="#030712">
  <title>Joe's Endurance CV</title>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      background: #030712;
      color: #e5e7eb;
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
    }

    .container {
      max-width: 640px;
      margin: 0 auto;
      padding: 2rem 1.25rem 3rem;
    }

    /* ---- Header ---- */
    .header {
      text-align: center;
      margin-bottom: 2.5rem;
    }
    .header h1 {
      font-size: 1.5rem;
      font-weight: 800;
      letter-spacing: 0.05em;
      color: #ffffff;
    }
    .header .trophy { font-size: 1.75rem; }

    /* ---- Stat Grid ---- */
    .stat-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 0.75rem;
      margin-bottom: 2rem;
    }
    @media (min-width: 480px) {
      .stat-grid { grid-template-columns: repeat(4, 1fr); }
    }
    .stat-card {
      background: #1f2937;
      border-radius: 0.75rem;
      padding: 1rem;
      text-align: center;
    }
    .stat-value {
      font-size: 1.5rem;
      font-weight: 800;
      color: #ffffff;
      line-height: 1.2;
    }
    .stat-label {
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      color: #9ca3af;
      margin-top: 0.25rem;
    }

    /* ---- Section headings ---- */
    .section-title {
      font-size: 0.75rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #9ca3af;
      margin-bottom: 0.75rem;
    }

    /* ---- Event Cards ---- */
    .events-list { margin-bottom: 2rem; }
    .event-card {
      background: #1f2937;
      border-radius: 0.75rem;
      padding: 0.875rem 1rem;
      margin-bottom: 0.5rem;
    }
    .event-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.5rem;
      margin-bottom: 0.375rem;
    }
    .event-name {
      font-weight: 600;
      font-size: 0.875rem;
      color: #ffffff;
      min-width: 0;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    .type-badge {
      flex-shrink: 0;
      font-size: 0.625rem;
      font-weight: 700;
      padding: 0.125rem 0.5rem;
      border-radius: 9999px;
    }
    .event-meta {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.5rem;
    }
    .event-metrics {
      font-size: 0.75rem;
      color: #9ca3af;
    }
    .event-dots {
      display: flex;
      align-items: center;
    }

    /* ---- Fun Facts ---- */
    .fun-facts { margin-bottom: 2rem; }
    .fun-fact {
      display: flex;
      align-items: baseline;
      gap: 0.5rem;
      font-size: 0.8125rem;
      color: #d1d5db;
      line-height: 1.5;
      margin-bottom: 0.375rem;
    }
    .fun-fact-icon { flex-shrink: 0; }

    /* ---- Footer ---- */
    .footer {
      text-align: center;
      font-size: 0.6875rem;
      color: #6b7280;
      border-top: 1px solid #1f2937;
      padding-top: 1.5rem;
      margin-top: 1rem;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1><span class="trophy">üèÜ</span> JOE'S ENDURANCE CV</h1>
    </div>

    <div class="stat-grid">
      <div class="stat-card">
        <div class="stat-value">${s.totalEvents}</div>
        <div class="stat-label">Total Events</div>
      </div>
      <div class="stat-card">
        <div class="stat-value">${s.totalDistance}</div>
        <div class="stat-label">Total Km</div>
      </div>
      <div class="stat-card">
        <div class="stat-value">${s.totalElevation.toLocaleString()}</div>
        <div class="stat-label">Total Elevation (m)</div>
      </div>
      <div class="stat-card">
        <div class="stat-value">${o}/5</div>
        <div class="stat-label">Highest Difficulty</div>
      </div>
    </div>

    <div class="events-list">
      <div class="section-title">Completed Events</div>
      ${d}
    </div>

    ${r?`
    <div class="fun-facts">
      <div class="section-title">Fun Facts</div>
      ${r}
    </div>`:""}

    <div class="footer">
      Generated from Achievement Wall &bull; ${F(i)}
    </div>
  </div>
</body>
</html>`}function Wt(s,n,t){const l=Ot(s,n),o=new Blob([l],{type:"text/html;charset=utf-8"}),i=URL.createObjectURL(o),d=document.createElement("a");d.href=i,d.download=`endurance-cv-${new Date().toISOString().slice(0,10)}.html`,d.click(),URL.revokeObjectURL(i)}function F(s){return s?String(s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"):""}function Gt(){const s=ie(),{events:n}=V(),{state:t}=I(),l=()=>{Wt(s,n,t.preferences)};return e.jsxs("button",{onClick:l,className:"w-full flex items-center gap-3 bg-gray-900/60 rounded-xl p-3 border border-gray-700/30 hover:border-gray-600 transition-colors text-left",children:[e.jsx(nt,{size:18,className:"text-sky-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white text-sm font-medium",children:"Export Profile HTML"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Shareable standalone page"})]})]})}function Bt({event:s}){const[n,t]=g.useState(Date.now());if(g.useEffect(()=>{const x=setInterval(()=>t(Date.now()),6e4);return()=>clearInterval(x)},[]),!s?.date)return null;const o=new Date(s.date+"T09:00:00").getTime()-n;if(o<=0)return e.jsx("div",{className:"bg-emerald-500/10 border border-emerald-500/30 rounded-2xl p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(me,{size:20,className:"text-emerald-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-emerald-400 font-bold text-sm",children:"Race Day!"}),e.jsxs("div",{className:"text-gray-400 text-xs",children:[s.name," ‚Äî Go crush it!"]})]})]})});const i=Math.floor(o/864e5),d=Math.floor(o%864e5/36e5),r=Math.floor(o%36e5/6e4),a=i<=7?"text-red-400":i<=30?"text-orange-400":"text-indigo-400",f=i<=7?"from-red-900/30 to-red-900/10":i<=30?"from-orange-900/30 to-orange-900/10":"from-indigo-900/30 to-indigo-900/10",c=i<=7?"border-red-700/30":i<=30?"border-orange-700/30":"border-indigo-700/30",m=[];return i>60&&m.push({label:"Base training",done:!0}),i>30&&m.push({label:"Build phase",done:i<=60}),i>14&&m.push({label:"Peak week",done:i<=30}),i>7&&m.push({label:"Taper",done:i<=14}),m.push({label:"Kit check",done:i<=3}),m.push({label:"Race day",done:!1}),e.jsx("div",{className:`bg-gradient-to-r ${f} border ${c} rounded-2xl p-4`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Se,{size:20,className:a}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-[10px] uppercase tracking-widest text-gray-500 font-bold mb-1",children:"Countdown to"}),e.jsx("div",{className:"text-white font-bold text-sm truncate",children:s.name}),e.jsx("div",{className:"flex gap-3 mt-3",children:[{value:i,label:"days"},{value:d,label:"hrs"},{value:r,label:"min"}].map(x=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`text-2xl font-black ${a}`,children:x.value}),e.jsx("div",{className:"text-[10px] text-gray-500 uppercase tracking-wider",children:x.label})]},x.label))}),e.jsx("div",{className:"flex flex-wrap gap-1.5 mt-3",children:m.map(x=>e.jsxs("span",{className:`text-[9px] px-2 py-0.5 rounded-full font-medium ${x.done?"bg-emerald-500/20 text-emerald-400":"bg-gray-700/40 text-gray-500"}`,children:[x.done?"‚úì ":"",x.label]},x.label))})]})]})})}function Ht(s){const n=s.filter(h=>h.status==="completed"&&h.date).sort((h,y)=>h.date.localeCompare(y.date));if(n.length===0)return{score:"fresh",daysSinceLast:null,avgGap:null,recentLoad:0,message:"No events logged yet"};const t=new Date,l=n[n.length-1],o=new Date(l.date),i=Math.floor((t-o)/864e5),d=[];for(let h=1;h<n.length;h++){const y=(new Date(n[h].date)-new Date(n[h-1].date))/864e5;y>0&&d.push(y)}const r=d.length>0?Math.round(d.reduce((h,y)=>h+y,0)/d.length):null,a=new Date(t-30*864e5),c=n.filter(h=>new Date(h.date)>=a).reduce((h,y)=>{const b=(y.distance||10)/10,p=(y.difficulty||3)/3;return h+b*p},0);let m,x;return i<=3?(m="fatigued",x=`Only ${i} day${i!==1?"s":""} since your last event ‚Äî allow recovery`):i<=7&&c>3?(m="fatigued",x="High recent load with short recovery ‚Äî ease off"):i<=14||c>2?(m="moderate",x=`${i} days since last event ‚Äî building back up`):(m="fresh",x=`${i} days recovered ‚Äî you're ready to go`),{score:m,daysSinceLast:i,avgGap:r,recentLoad:Math.round(c*10)/10,message:x}}const Vt={fresh:{color:"#10b981",bg:"bg-emerald-500/10",border:"border-emerald-500/30",icon:me,label:"Fresh"},moderate:{color:"#f59e0b",bg:"bg-amber-500/10",border:"border-amber-500/30",icon:et,label:"Moderate"},fatigued:{color:"#ef4444",bg:"bg-red-500/10",border:"border-red-500/30",icon:Ie,label:"Fatigued"}};function qt({events:s}){const n=Ht(s),t=Vt[n.score],l=t.icon;return e.jsxs("div",{className:`${t.bg} border ${t.border} rounded-2xl p-4`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(dt,{size:18,style:{color:t.color}}),e.jsx("span",{className:"text-white font-bold text-sm",children:"Recovery Status"}),e.jsx("span",{className:"ml-auto text-xs font-bold px-2 py-0.5 rounded-full",style:{backgroundColor:t.color+"20",color:t.color},children:t.label})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(l,{size:16,style:{color:t.color}}),e.jsx("p",{className:"text-gray-300 text-sm",children:n.message})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-black text-white",children:n.daysSinceLast??"‚Äî"}),e.jsx("div",{className:"text-[10px] text-gray-500 uppercase tracking-wider",children:"Days rest"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-black text-white",children:n.avgGap??"‚Äî"}),e.jsx("div",{className:"text-[10px] text-gray-500 uppercase tracking-wider",children:"Avg gap"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-black text-white",children:n.recentLoad}),e.jsx("div",{className:"text-[10px] text-gray-500 uppercase tracking-wider",children:"30d load"})]})]})]})}function Yt({stats:s,onClose:n}){const t=g.useRef(null),[l,o]=g.useState(!1);g.useEffect(()=>{const d=t.current;if(!d)return;const r=d.getContext("2d"),a=1080,f=1920;d.width=a,d.height=f;const c=r.createLinearGradient(0,0,a,f);c.addColorStop(0,"#1e1b4b"),c.addColorStop(.5,"#312e81"),c.addColorStop(1,"#000000"),r.fillStyle=c,r.fillRect(0,0,a,f),r.globalAlpha=.08,r.beginPath(),r.arc(200,400,300,0,Math.PI*2),r.fillStyle="#8b5cf6",r.fill(),r.beginPath(),r.arc(880,1400,250,0,Math.PI*2),r.fillStyle="#ef4444",r.fill(),r.globalAlpha=1,r.font="120px serif",r.textAlign="center",r.fillText("üèÜ",a/2,280),r.font="bold 64px -apple-system, system-ui, sans-serif",r.fillStyle="#ffffff",r.fillText("JOE'S ENDURANCE CV",a/2,400),r.font="28px -apple-system, system-ui, sans-serif",r.fillStyle="#a5b4fc",r.fillText("Every kilometre earned. Every peak conquered.",a/2,460);const m=[{value:String(s.totalEvents),label:"EVENTS"},{value:`${s.totalDistance}km`,label:"DISTANCE"},{value:`${Math.round(s.totalElevation/1e3)}k m`,label:"ELEVATION"}],x=580,h=a/(m.length+1);m.forEach((p,k)=>{const v=h*(k+1);r.fillStyle="rgba(255,255,255,0.05)",r.beginPath(),r.roundRect(v-130,x-60,260,140,20),r.fill(),r.font="bold 56px -apple-system, system-ui, sans-serif",r.fillStyle="#ffffff",r.fillText(p.value,v,x+10),r.font="bold 20px -apple-system, system-ui, sans-serif",r.fillStyle="#6b7280",r.fillText(p.label,v,x+55)}),r.textAlign="left",r.font="bold 36px -apple-system, system-ui, sans-serif",r.fillStyle="#a5b4fc",r.fillText("TOP CHALLENGES",100,850);const y=(s.topEvents||[]).slice(0,5);y.forEach((p,k)=>{const v=920+k*100;r.fillStyle="rgba(255,255,255,0.03)",r.beginPath(),r.roundRect(80,v-30,a-160,80,16),r.fill(),r.font="40px serif",r.textAlign="left",r.fillText(p.badge||"üèîÔ∏è",110,v+25),r.font="bold 32px -apple-system, system-ui, sans-serif",r.fillStyle="#ffffff",r.fillText(p.name?.slice(0,28)||"",180,v+10),r.font="24px -apple-system, system-ui, sans-serif",r.fillStyle="#6b7280",r.fillText(p.distance?`${p.distance}km`:"",180,v+45),p.distance&&(r.textAlign="right",r.font="bold 36px -apple-system, system-ui, sans-serif",r.fillStyle="#10b981",r.fillText(`${p.distance}km`,a-110,v+20),r.textAlign="left")});const b=920+y.length*100+60;r.textAlign="center",r.font="bold 28px -apple-system, system-ui, sans-serif",r.fillStyle="#f59e0b",r.fillText(`üèÖ ${s.badgesCount||0} badges unlocked`,a/2,b),r.font="24px -apple-system, system-ui, sans-serif",r.fillStyle="rgba(255,255,255,0.2)",r.fillText("achievement-wall",a/2,f-60),o(!0)},[s]);const i=()=>{const d=t.current;if(!d)return;const r=document.createElement("a");r.download="endurance-cv-story.png",r.href=d.toDataURL("image/png"),r.click()};return e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm px-4",children:e.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-2xl p-4 max-w-sm w-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{size:18,className:"text-pink-400"}),e.jsx("span",{className:"text-white font-bold text-sm",children:"Story Card"})]}),e.jsx("button",{onClick:n,className:"text-gray-500 hover:text-white",children:e.jsx(O,{size:18})})]}),e.jsx("div",{className:"aspect-[9/16] rounded-xl overflow-hidden bg-gray-800 mb-3",children:e.jsx("canvas",{ref:t,className:"w-full h-full",style:{imageRendering:"auto"}})}),l&&e.jsxs("button",{onClick:i,className:"w-full py-2.5 rounded-xl bg-gradient-to-r from-purple-600 to-pink-600 text-white font-bold text-sm hover:from-purple-500 hover:to-pink-500 transition-all flex items-center justify-center gap-2",children:[e.jsx(q,{size:16})," Download for Instagram"]})]})})}function Jt({value:s,onChange:n}){return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ut,{size:18,className:"text-indigo-400",style:{color:s}}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white text-sm font-medium",children:"Accent Color"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Theme color throughout the app"})]})]}),e.jsx("div",{className:"flex gap-1.5",children:Ee.map(t=>e.jsx("button",{onClick:()=>n(t.hex),className:`w-6 h-6 rounded-full transition-all ${s===t.hex?"ring-2 ring-white ring-offset-2 ring-offset-gray-900 scale-110":"hover:scale-110"}`,style:{backgroundColor:t.hex},title:t.name},t.hex))})]})}function Kt({onClose:s}){const{state:n,dispatch:t}=I(),l=n.preferences?.profile??{name:"",tagline:"",photo:null},[o,i]=g.useState({...l}),d=g.useRef(null),r=async f=>{const c=f.target.files?.[0];if(!c)return;const m=document.createElement("canvas"),x=m.getContext("2d"),h=new Image;h.onload=()=>{m.width=200,m.height=200;const b=Math.min(h.width,h.height),p=(h.width-b)/2,k=(h.height-b)/2;x.drawImage(h,p,k,b,b,0,0,200,200);const v=m.toDataURL("image/jpeg",.7);i({...o,photo:v})},h.src=URL.createObjectURL(c),f.target.value=""},a=()=>{t({type:"UPDATE_PREFERENCES",payload:{profile:o}}),s()};return e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/70 backdrop-blur-sm px-6",children:e.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-2xl p-6 max-w-sm w-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-5",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:"Edit Profile"}),e.jsx("button",{onClick:s,className:"text-gray-500 hover:text-white",children:e.jsx(O,{size:18})})]}),e.jsxs("div",{className:"flex justify-center mb-5",children:[e.jsxs("button",{onClick:()=>d.current?.click(),className:"relative w-24 h-24 rounded-full overflow-hidden bg-gray-800 border-2 border-gray-700 hover:border-indigo-500 transition-colors group",children:[o.photo?e.jsx("img",{src:o.photo,alt:"Profile",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(he,{size:32,className:"text-gray-600"})}),e.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(Oe,{size:20,className:"text-white"})})]}),e.jsx("input",{ref:d,type:"file",accept:"image/*",onChange:r,className:"hidden"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-[10px] uppercase tracking-widest text-gray-400 font-bold mb-1.5 block",children:"Name"}),e.jsx("input",{type:"text",value:o.name,onChange:f=>i({...o,name:f.target.value}),placeholder:"Joe",maxLength:30,className:"w-full bg-gray-800 border border-gray-700 rounded-xl px-3 py-2.5 text-sm text-white placeholder:text-gray-500 focus:outline-none focus:border-indigo-500"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"text-[10px] uppercase tracking-widest text-gray-400 font-bold mb-1.5 block",children:"Tagline"}),e.jsx("input",{type:"text",value:o.tagline,onChange:f=>i({...o,tagline:f.target.value}),placeholder:"Ultra runner since 2021",maxLength:60,className:"w-full bg-gray-800 border border-gray-700 rounded-xl px-3 py-2.5 text-sm text-white placeholder:text-gray-500 focus:outline-none focus:border-indigo-500"})]}),o.photo&&e.jsx("button",{onClick:()=>i({...o,photo:null}),className:"w-full mb-3 text-sm text-gray-500 hover:text-red-400 transition-colors",children:"Remove photo"}),e.jsx("button",{onClick:a,className:"w-full py-2.5 rounded-xl bg-indigo-600 text-white font-bold text-sm hover:bg-indigo-500 transition-colors",children:"Save Profile"})]})})}function Xt(s){const n=["Name","Type","Status","Distance (km)","Elevation (m)","Location","Date","Time","Difficulty","Completions","Rating"],t=a=>{if(a==null)return"";const f=String(a);return f.includes(",")||f.includes('"')||f.includes(`
`)?`"${f.replace(/"/g,'""')}"`:f},l=s.map(a=>[t(a.name),t(a.type),t(a.status),a.distance??"",a.elevation??"",t(a.location),a.date??"",a.time??"",a.difficulty??"",a.completions??1,a.review?.rating??""].join(",")),o=[n.join(","),...l].join(`
`),i=new Blob([o],{type:"text/csv;charset=utf-8;"}),d=URL.createObjectURL(i),r=document.createElement("a");r.href=d,r.download=`endurance-cv-${new Date().toISOString().slice(0,10)}.csv`,r.click(),URL.revokeObjectURL(d)}const Zt={backgroundColor:"#1f2937",border:"1px solid #374151",borderRadius:"12px",color:"#fff",fontSize:12};function ws({setPage:s}){const{completed:n,upcoming:t}=V(),l=ie(),{totalDistance:o,totalEvents:i,totalElevation:d,cumulativeData:r,yearStats:a}=l,{unlocked:f}=Ae(),{state:c,dispatch:m}=I(),[x,h]=g.useState(!1),[y,b]=g.useState(!1),[p,k]=g.useState(null),[v,L]=g.useState(!1),[N,M]=g.useState(!1),[S,J]=g.useState(!1),[K,X]=g.useState([]),[pe,Z]=g.useState(!1),[ge,W]=g.useState(!1),Q=g.useRef(null);g.useEffect(()=>{c.preferences?.unlockedAchievements||m({type:"UPDATE_PREFERENCES",payload:{unlockedAchievements:[]}})},[c.preferences?.unlockedAchievements,m]),g.useEffect(()=>{if(!c.preferences?.unlockedAchievements)return;const u=Pt(l,c.events,c.preferences);u.length>0&&(X(u),m({type:"UPDATE_PREFERENCES",payload:{unlockedAchievements:[...c.preferences.unlockedAchievements,...u]}}))},[l,c.events,c.preferences?.unlockedAchievements,m]);const be=()=>Et(c),ye=async u=>{const C=u.target.files?.[0];if(C){try{const j=await Rt(C);m({type:"IMPORT_DATA",payload:j}),k("success"),setTimeout(()=>k(null),2e3)}catch(j){k(j.message),setTimeout(()=>k(null),3e3)}u.target.value=""}},ve=()=>{m({type:"RESET_TO_SEED"}),b(!1),h(!1)},je=Math.round(Re()/1024);return e.jsxs("div",{className:"pb-24 sm:pb-8",children:[K.length>0&&e.jsx(Ut,{achievements:K,onDismiss:()=>X([])}),e.jsxs("div",{className:"relative overflow-hidden",style:{background:"linear-gradient(135deg, #0f172a 0%, #1e1b4b 50%, #0f172a 100%)"},children:[e.jsx("div",{className:"absolute inset-0 opacity-10",style:{backgroundImage:"radial-gradient(circle at 20% 50%, #8b5cf6 0%, transparent 50%), radial-gradient(circle at 80% 50%, #ef4444 0%, transparent 50%)"}}),e.jsxs("div",{className:"relative px-6 pt-12 pb-10 text-center max-w-xl mx-auto",children:[e.jsxs("div",{className:"absolute top-4 right-4 flex gap-2",children:[e.jsx("button",{onClick:()=>M(!0),className:"p-2 rounded-full bg-white/10 text-gray-400 hover:text-white hover:bg-white/20 transition-colors",children:e.jsx($e,{size:18})}),e.jsx("button",{onClick:()=>h(!x),className:"p-2 rounded-full bg-white/10 text-gray-400 hover:text-white hover:bg-white/20 transition-colors",children:e.jsx(kt,{size:18})})]}),c.preferences?.profile?.photo?e.jsx("button",{onClick:()=>W(!0),className:"mx-auto mb-4",children:e.jsx("img",{src:c.preferences.profile.photo,alt:"",className:"w-20 h-20 rounded-full border-2 border-white/20 object-cover"})}):e.jsx("div",{className:"text-5xl mb-4",children:"üèÜ"}),e.jsx("h1",{className:"text-3xl font-black tracking-tight text-white mb-2",children:c.preferences?.profile?.name?`${c.preferences.profile.name.toUpperCase()}'S ENDURANCE CV`:"JOE'S ENDURANCE CV"}),e.jsx("p",{className:"text-gray-400 text-sm leading-relaxed",children:c.preferences?.profile?.tagline||"Every kilometre earned. Every peak conquered. Every wall broken through."}),e.jsx("div",{className:"grid grid-cols-4 gap-3 mt-8",children:[{num:i,suffix:"",label:"Events",color:"#f59e0b",icon:Te},{num:o,suffix:"km",label:"Distance",color:"#10b981",icon:We},{num:parseFloat((d/1e3).toFixed(1)),suffix:"k",decimals:1,label:"Elev (m)",color:"#8b5cf6",icon:Ge},{num:100,suffix:"km",label:"Longest",color:"#ef4444",icon:De}].map((u,C)=>e.jsxs("div",{className:"bg-white/5 backdrop-blur rounded-xl p-3 border border-white/10",children:[e.jsx(u.icon,{size:16,style:{color:u.color},className:"mx-auto mb-1"}),e.jsx("div",{className:"text-xl font-black text-white",children:e.jsx(fe,{value:u.num,suffix:u.suffix,decimals:u.decimals||0})}),e.jsx("div",{className:"text-[10px] text-gray-400 uppercase tracking-wider",children:u.label})]},C))})]})]}),e.jsx("div",{className:"px-4 mt-6",children:e.jsx($t,{})}),e.jsx("div",{className:"px-4 mt-4",children:e.jsx(It,{events:c.events,checkins:c.preferences?.weeklyCheckins??[]})}),e.jsx("div",{className:"px-4 mt-4",children:e.jsx(qt,{events:c.events})}),(()=>{const u=c.preferences?.goals??{distance:500,elevation:5e3,events:10},C=new Date().getFullYear(),j=(T,D)=>{const z=Math.max(0,parseInt(D)||0);m({type:"UPDATE_PREFERENCES",payload:{goals:{...u,[T]:z}}})};return e.jsxs("div",{className:"px-4 mt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h2",{className:"text-white font-bold text-lg",children:a.hasYearDates?`${C} Goals`:"All-Time Goals"}),e.jsx("button",{onClick:()=>L(!v),className:"text-indigo-400 text-sm font-medium hover:text-indigo-300",children:v?"Done":"Edit"})]}),e.jsxs("div",{className:"bg-gray-800/60 rounded-2xl p-5 border border-gray-700/50",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx(G,{value:a.yearDistance,target:u.distance,label:"Distance",unit:"km",color:"#10b981"}),e.jsx(G,{value:a.yearElevation,target:u.elevation,label:"Elevation",unit:"m",color:"#8b5cf6"}),e.jsx(G,{value:a.yearEvents,target:u.events,label:"Events",unit:"",color:"#f59e0b"})]}),v&&e.jsx("div",{className:"grid grid-cols-3 gap-3 mt-4 pt-4 border-t border-gray-700/50",children:[{key:"distance",label:"Distance (km)",val:u.distance},{key:"elevation",label:"Elevation (m)",val:u.elevation},{key:"events",label:"Events",val:u.events}].map(T=>e.jsxs("div",{className:"text-center",children:[e.jsx("label",{className:"text-[10px] text-gray-500 uppercase tracking-wider block mb-1",children:T.label}),e.jsx("input",{type:"number",value:T.val,onChange:D=>j(T.key,D.target.value),className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-2 py-1.5 text-white text-center text-sm focus:border-indigo-500 focus:outline-none"})]},T.key))})]})]})})(),(()=>{const u=c.preferences?.weeklyCheckins??[],C=ce(u),{current:j,longest:T}=Y(u),D=(()=>{if(j===0||u.length===0)return null;const E=[...new Set(u)].sort(),A=E.length-j;return A>=0&&A<E.length?new Date(E[A]).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}):null})(),z=[4,8,12,26,52],ee=z[z.length-1],we=Math.min(j/ee,1)*100,ke=Math.min(2,1+j/26);return e.jsxs("div",{className:"px-4 mt-4",children:[e.jsx("style",{children:`
              @keyframes confetti-burst {
                0% { transform: translate(0, 0) scale(1); opacity: 1; }
                100% { transform: translate(var(--cx), var(--cy)) scale(0); opacity: 0; }
              }
              @keyframes flame-pulse {
                0%, 100% { filter: brightness(1); }
                50% { filter: brightness(1.3); }
              }
              .confetti-particle {
                position: absolute;
                width: 8px;
                height: 8px;
                border-radius: 50%;
                animation: confetti-burst 0.7s ease-out forwards;
                pointer-events: none;
              }
            `}),e.jsxs("div",{className:"bg-gray-800/60 rounded-2xl p-5 border border-gray-700/50",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"text-4xl flex-shrink-0 select-none",style:{transform:`scale(${ke})`,transition:"transform 0.5s ease",animation:j>0?"flame-pulse 2s ease-in-out infinite":"none",transformOrigin:"center bottom"},children:j>0?"üî•":"‚ùÑÔ∏è"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-white font-black text-xl leading-tight",children:j>0?`${j} week streak`:"No active streak"}),e.jsx("div",{className:"text-gray-500 text-xs mt-1",children:j>0?e.jsxs(e.Fragment,{children:["Best: ",T," weeks",D&&e.jsxs(e.Fragment,{children:[" ‚Ä¢ Started: ",D]})]}):"Check in weekly to build a streak"})]}),e.jsx("div",{className:"relative flex-shrink-0",children:e.jsx("button",{onClick:E=>{if(!C){m({type:"UPDATE_PREFERENCES",payload:{weeklyCheckins:Pe(u)}});const $=E.currentTarget.parentElement,Ne=["#f59e0b","#ef4444","#10b981","#8b5cf6","#3b82f6","#ec4899","#14b8a6","#f97316"];for(let P=0;P<8;P++){const R=document.createElement("div");R.className="confetti-particle";const te=P/8*2*Math.PI,se=30+Math.random()*20;R.style.setProperty("--cx",`${Math.cos(te)*se}px`),R.style.setProperty("--cy",`${Math.sin(te)*se}px`),R.style.backgroundColor=Ne[P],R.style.left="50%",R.style.top="50%",R.style.marginLeft="-4px",R.style.marginTop="-4px",$.appendChild(R),setTimeout(()=>R.remove(),700)}}},className:`px-4 py-2 rounded-xl text-sm font-bold transition-all ${C?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30":"bg-indigo-600 hover:bg-indigo-500 text-white active:scale-95"}`,children:C?"‚úì Done":"I trained"})})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("div",{className:"relative h-2 bg-gray-900/60 rounded-full overflow-visible",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 bg-gradient-to-r from-orange-500 to-amber-400 rounded-full transition-all duration-700",style:{width:`${we}%`}}),z.map(E=>{const A=E/ee*100,$=j>=E;return e.jsxs("div",{className:"absolute top-1/2 -translate-y-1/2",style:{left:`${A}%`},children:[e.jsx("div",{className:`w-3 h-3 rounded-full border-2 -ml-1.5 transition-colors ${$?"bg-amber-400 border-amber-300":"bg-gray-700 border-gray-600"}`}),e.jsxs("div",{className:`absolute top-4 left-1/2 -translate-x-1/2 text-[9px] font-bold whitespace-nowrap ${$?"text-amber-400":"text-gray-600"}`,children:[E,"w"]})]},E)})]})})]})]})})(),t&&e.jsx("div",{className:"px-4 mt-4",children:e.jsxs("button",{onClick:()=>s("next"),className:"w-full bg-gradient-to-r from-red-900/60 to-orange-900/60 border border-red-700/40 rounded-2xl p-4 text-left hover:border-red-600/60 transition-all active:scale-[0.98]",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] uppercase tracking-widest text-red-400 font-bold mb-1",children:"Next Target"}),e.jsxs("div",{className:"text-white font-bold text-lg",children:["üéØ ",t.name]}),e.jsxs("div",{className:"text-gray-400 text-sm mt-0.5",children:[t.distance,"km ¬∑ ",t.date," ¬∑ ",t.phase]})]}),e.jsxs("div",{className:"text-right flex-shrink-0 ml-3",children:[ae(B(t.date))&&e.jsx("div",{className:"text-orange-400 text-xs font-bold",children:ae(B(t.date))}),e.jsx(Me,{size:20,className:"text-red-400 ml-auto"})]})]}),e.jsx("div",{className:"mt-3 w-full bg-gray-900/60 rounded-full h-1.5",children:e.jsx("div",{className:"bg-gradient-to-r from-red-500 to-orange-500 h-1.5 rounded-full transition-all duration-700",style:{width:`${t.progress}%`}})})]})}),t&&e.jsx("div",{className:"px-4 mt-4",children:e.jsx(Bt,{event:t})}),e.jsxs("div",{className:"px-4 mt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h2",{className:"text-white font-bold text-lg",children:"Completed Challenges"}),e.jsxs("button",{onClick:()=>s("events"),className:"text-indigo-400 text-sm font-medium flex items-center gap-1 hover:text-indigo-300",children:["View all ",e.jsx(_,{size:14})]})]}),e.jsx("div",{className:"flex gap-3 overflow-x-auto pb-2 -mx-4 px-4 no-scrollbar",children:[...n].reverse().map(u=>e.jsxs("button",{onClick:()=>s("events"),className:"flex-shrink-0 w-44 rounded-2xl overflow-hidden border border-gray-800 hover:border-gray-600 transition-all text-left active:scale-[0.98]",children:[e.jsx("div",{className:"h-20 flex items-center justify-center text-4xl",style:{background:u.heroImage},children:u.badge}),e.jsxs("div",{className:"p-3 bg-gray-800/80",children:[e.jsx("div",{className:"text-white font-bold text-sm truncate",children:u.name}),e.jsxs("div",{className:"text-gray-400 text-xs mt-0.5 flex items-center gap-2",children:[u.distance&&e.jsxs("span",{children:[u.distance,"km"]}),e.jsx("span",{style:{color:le[u.type]},children:u.type})]}),u.completions>1&&e.jsxs("span",{className:"inline-block mt-1 bg-indigo-500/20 text-indigo-300 text-[10px] font-bold px-1.5 py-0.5 rounded",children:["√ó",u.completions]})]})]},u.id))})]}),e.jsxs("div",{className:"px-4 mt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h2",{className:"text-white font-bold text-lg",children:"Journey So Far"}),e.jsxs("button",{onClick:()=>s("stats"),className:"text-indigo-400 text-sm font-medium flex items-center gap-1 hover:text-indigo-300",children:["Full stats ",e.jsx(_,{size:14})]})]}),e.jsxs("div",{className:"bg-gray-800/60 rounded-2xl p-4 border border-gray-700/50",children:[e.jsx(Be,{width:"100%",height:160,children:e.jsxs(He,{data:r,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"homeGrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"#10b981",stopOpacity:.3}),e.jsx("stop",{offset:"100%",stopColor:"#10b981",stopOpacity:0})]})}),e.jsx(Ve,{dataKey:"name",tick:{fill:"#6b7280",fontSize:10},axisLine:!1,tickLine:!1}),e.jsx(qe,{tick:{fill:"#6b7280",fontSize:10},axisLine:!1,tickLine:!1,unit:"km"}),e.jsx(Ye,{contentStyle:Zt,formatter:u=>[`${u}km`,"Total"]}),e.jsx(Je,{type:"monotone",dataKey:"total",stroke:"#10b981",strokeWidth:2,fill:"url(#homeGrad)",dot:{fill:"#10b981",r:4}})]})}),e.jsx("p",{className:"text-center text-gray-500 text-xs mt-1",children:"Cumulative distance across all events"})]})]}),e.jsxs("div",{className:"px-4 mt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h2",{className:"text-white font-bold text-lg",children:"Badges"}),e.jsxs("button",{onClick:()=>s("milestones"),className:"text-indigo-400 text-sm font-medium flex items-center gap-1 hover:text-indigo-300",children:["All badges ",e.jsx(_,{size:14})]})]}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 -mx-4 px-4 no-scrollbar",children:f.map((u,C)=>e.jsxs("div",{className:"flex-shrink-0 bg-gray-800/60 border border-gray-700/50 rounded-xl px-3 py-2.5 text-center min-w-[80px]",children:[e.jsx("div",{className:"text-2xl mb-1",children:u.icon}),e.jsx("div",{className:"text-[10px] text-gray-300 font-medium leading-tight",children:u.text})]},C))})]}),n.length>=3&&e.jsx("div",{className:"px-4 mt-6",children:e.jsx("button",{onClick:()=>s("wrapped"),className:"w-full bg-gradient-to-r from-indigo-600 to-purple-600 rounded-2xl p-4 border border-indigo-500/30 text-left hover:from-indigo-500 hover:to-purple-500 transition-all active:scale-[0.98]",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(H,{size:20,className:"text-amber-300"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-bold text-sm",children:"Year in Review"}),e.jsx("div",{className:"text-indigo-200 text-xs",children:"Your Wrapped-style journey recap"})]}),e.jsx(_,{size:16,className:"text-white/60 ml-auto"})]})})}),x&&e.jsx("div",{className:"px-4 mt-6",children:e.jsxs("div",{className:"bg-gray-800/60 rounded-2xl p-5 border border-gray-700/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-5",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ht,{size:18,className:"text-amber-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white text-sm font-medium",children:"OLED Black Mode"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"True black for AMOLED screens"})]})]}),e.jsx("button",{onClick:()=>m({type:"UPDATE_PREFERENCES",payload:{oledMode:!c.preferences?.oledMode}}),className:`relative w-11 h-6 rounded-full transition-colors ${c.preferences?.oledMode?"bg-amber-500":"bg-gray-600"}`,children:e.jsx("span",{className:`absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full transition-transform ${c.preferences?.oledMode?"translate-x-5":""}`})})]}),e.jsxs("div",{className:"flex items-center justify-between mb-5",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(gt,{size:18,className:"text-cyan-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white text-sm font-medium",children:"Reduced Motion"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Disable animations & transitions"})]})]}),e.jsx("button",{onClick:()=>m({type:"UPDATE_PREFERENCES",payload:{reducedMotion:!c.preferences?.reducedMotion}}),className:`relative w-11 h-6 rounded-full transition-colors ${c.preferences?.reducedMotion?"bg-cyan-500":"bg-gray-600"}`,children:e.jsx("span",{className:`absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full transition-transform ${c.preferences?.reducedMotion?"translate-x-5":""}`})})]}),e.jsxs("div",{className:"flex items-center justify-between mb-5",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ct,{size:18,className:"text-amber-300"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white text-sm font-medium",children:"Light Mode"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Bright theme for daylight"})]})]}),e.jsx("button",{onClick:()=>m({type:"UPDATE_PREFERENCES",payload:{lightMode:!c.preferences?.lightMode}}),className:`relative w-11 h-6 rounded-full transition-colors ${c.preferences?.lightMode?"bg-amber-400":"bg-gray-600"}`,children:e.jsx("span",{className:`absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full transition-transform ${c.preferences?.lightMode?"translate-x-5":""}`})})]}),e.jsx("div",{className:"mb-5",children:e.jsx(Jt,{value:c.preferences?.accentColor??"#6366f1",onChange:u=>m({type:"UPDATE_PREFERENCES",payload:{accentColor:u}})})}),e.jsx("h3",{className:"text-white font-bold text-sm mb-4",children:"Tools"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-5",children:[e.jsxs("button",{onClick:()=>s("calendar"),className:"flex items-center gap-2 bg-gray-900/60 rounded-xl p-3 border border-gray-700/30 hover:border-gray-600 transition-colors text-left",children:[e.jsx(de,{size:18,className:"text-indigo-400"}),e.jsx("div",{className:"text-white text-sm font-medium",children:"Calendar"})]}),e.jsxs("button",{onClick:()=>s("pace"),className:"flex items-center gap-2 bg-gray-900/60 rounded-xl p-3 border border-gray-700/30 hover:border-gray-600 transition-colors text-left",children:[e.jsx(Ke,{size:18,className:"text-emerald-400"}),e.jsx("div",{className:"text-white text-sm font-medium",children:"Pace Calc"})]}),e.jsxs("button",{onClick:()=>s("gear"),className:"flex items-center gap-2 bg-gray-900/60 rounded-xl p-3 border border-gray-700/30 hover:border-gray-600 transition-colors text-left",children:[e.jsx(ot,{size:18,className:"text-orange-400"}),e.jsx("div",{className:"text-white text-sm font-medium",children:"Gear"})]}),e.jsxs("button",{onClick:()=>s("routes"),className:"flex items-center gap-2 bg-gray-900/60 rounded-xl p-3 border border-gray-700/30 hover:border-gray-600 transition-colors text-left",children:[e.jsx(Xe,{size:18,className:"text-sky-400"}),e.jsx("div",{className:"text-white text-sm font-medium",children:"Routes"})]}),e.jsxs("button",{onClick:()=>W(!0),className:"flex items-center gap-2 bg-gray-900/60 rounded-xl p-3 border border-gray-700/30 hover:border-gray-600 transition-colors text-left col-span-2",children:[e.jsx(he,{size:18,className:"text-violet-400"}),e.jsx("div",{className:"text-white text-sm font-medium",children:"Edit Profile"})]})]}),e.jsx("h3",{className:"text-white font-bold text-sm mb-4",children:"Data Management"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:be,className:"w-full flex items-center gap-3 bg-gray-900/60 rounded-xl p-3 border border-gray-700/30 hover:border-gray-600 transition-colors text-left",children:[e.jsx(q,{size:18,className:"text-emerald-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white text-sm font-medium",children:"Export Data"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Download as JSON file"})]})]}),e.jsxs("button",{onClick:()=>Q.current?.click(),className:"w-full flex items-center gap-3 bg-gray-900/60 rounded-xl p-3 border border-gray-700/30 hover:border-gray-600 transition-colors text-left",children:[e.jsx(Ze,{size:18,className:"text-indigo-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white text-sm font-medium",children:"Import Data"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Replace with JSON file"})]})]}),e.jsxs("button",{onClick:()=>window.print(),className:"w-full flex items-center gap-3 bg-gray-900/60 rounded-xl p-3 border border-gray-700/30 hover:border-gray-600 transition-colors text-left",children:[e.jsx(yt,{size:18,className:"text-cyan-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white text-sm font-medium",children:"Print / PDF"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Print-friendly view of your CV"})]})]}),e.jsx(Gt,{}),e.jsxs("button",{onClick:()=>Xt(c.events),className:"w-full flex items-center gap-3 bg-gray-900/60 rounded-xl p-3 border border-gray-700/30 hover:border-gray-600 transition-colors text-left",children:[e.jsx(lt,{size:18,className:"text-teal-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white text-sm font-medium",children:"Export CSV"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Spreadsheet / Strava format"})]})]}),e.jsxs("button",{onClick:()=>Z(!0),className:"w-full flex items-center gap-3 bg-gray-900/60 rounded-xl p-3 border border-gray-700/30 hover:border-gray-600 transition-colors text-left",children:[e.jsx(xe,{size:18,className:"text-pink-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white text-sm font-medium",children:"Instagram Story"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Download a 1080√ó1920 story card"})]})]}),e.jsxs("button",{onClick:()=>b(!0),className:"w-full flex items-center gap-3 bg-gray-900/60 rounded-xl p-3 border border-red-900/30 hover:border-red-700/50 transition-colors text-left",children:[e.jsx(jt,{size:18,className:"text-red-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white text-sm font-medium",children:"Reset to Defaults"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Restore original seed data"})]})]})]}),p&&e.jsx("div",{className:`mt-3 text-sm px-3 py-2 rounded-lg ${p==="success"?"bg-emerald-900/30 text-emerald-300":"bg-red-900/30 text-red-300"}`,children:p==="success"?"Data imported successfully!":p}),e.jsxs("div",{className:"mt-3 text-center text-gray-600 text-[10px]",children:["Storage: ",je,"KB used"]})]})}),e.jsx("input",{ref:Q,type:"file",accept:".json",onChange:ye,className:"hidden"}),y&&e.jsx(ze,{title:"Reset All Data?",message:"This will replace all your events, milestones, and settings with the original defaults. This cannot be undone.",onConfirm:ve,onCancel:()=>b(!1)}),N&&e.jsx(Dt,{stats:{totalEvents:i,totalDistance:o,totalElevation:d,topEvents:n.slice().reverse().slice(0,5),badgesCount:f.length},onClose:()=>M(!1)}),pe&&e.jsx(Yt,{stats:{totalEvents:i,totalDistance:o,totalElevation:d,topEvents:n.slice().reverse().slice(0,5),badgesCount:f.length},onClose:()=>Z(!1)}),ge&&e.jsx(Kt,{onClose:()=>W(!1)})]})}export{ws as default};
