import{u as H,r as I}from"./index-CSeORV3c.js";import{c as J,a as K}from"./pace-Dbu3TRjw.js";function V(){const{state:y}=H(),a=y.events.filter(n=>n.status==="completed"),u=y.preferences?.bodyWeight??102;return I.useMemo(()=>{const n=a.reduce((e,t)=>e+(t.distance||0)*(t.completions||1),0),P=a.reduce((e,t)=>e+(t.completions||1),0),m=a.reduce((e,t)=>e+(t.elevation||0)*(t.completions||1),0),h=Math.max(...a.map(e=>e.elevation||0),0),b=a.find(e=>e.elevation===h),C=a.filter(e=>e.distance).sort((e,t)=>e.distance-t.distance).map(e=>({name:e.name.length>16?e.name.slice(0,14)+"â€¦":e.name,distance:e.distance,fill:e.color})),Y=a.filter(e=>e.distance).sort((e,t)=>e.distance-t.distance).reduce((e,t)=>{const G=e.length>0?e[e.length-1].total:0;return e.push({name:t.name.length>14?t.name.slice(0,12)+"â€¦":t.name,total:G+(t.distance||0)*(t.completions||1)}),e},[]),M=Object.entries(a.reduce((e,t)=>(e[t.type]=(e[t.type]||0)+(t.completions||1),e),{})).map(([e,t])=>({name:e,value:t})),S=a.filter(e=>e.distance),A=a.filter(e=>e.elevation),o=S.sort((e,t)=>t.distance-e.distance)[0],s=A.sort((e,t)=>t.elevation-e.elevation)[0],i=[...a].sort((e,t)=>t.difficulty-e.difficulty)[0],c=[...a].sort((e,t)=>t.completions-e.completions)[0],l=a.map(e=>({...e,pace:J(e.time,e.distance)})).filter(e=>e.pace!=null).sort((e,t)=>e.pace-t.pace)[0]||null,B={longestDistance:o?{value:o.distance,name:o.name,date:o.date}:null,mostElevation:s?{value:s.elevation,name:s.name,date:s.date}:null,hardestEvent:i?{value:i.difficulty,name:i.name,date:i.date}:null,mostCompletions:c?{value:c.completions,name:c.name,date:c.date}:null,fastestPace:l?{value:K(l.pace),name:l.name,date:l.date}:null},r=[],L=a.filter(e=>e.date).sort((e,t)=>e.date.localeCompare(t.date));let g=0,E=0,D=0;for(const e of L)e.distance&&e.distance>g&&(g=e.distance,r.push({date:e.date,category:"Distance",value:`${e.distance}km`,name:e.name,icon:"ðŸ…",color:"#10b981"})),e.elevation&&e.elevation>E&&(E=e.elevation,r.push({date:e.date,category:"Elevation",value:`${e.elevation}m`,name:e.name,icon:"â›°ï¸",color:"#f59e0b"})),e.difficulty&&e.difficulty>D&&(D=e.difficulty,r.push({date:e.date,category:"Difficulty",value:`${e.difficulty}/5`,name:e.name,icon:"ðŸ”¥",color:"#ef4444"}));const W=n>400?"Edinburgh":n>300?"Manchester":"Bristol",j=[{icon:"ðŸ—ºï¸",text:`${n}km is roughly London to ${W}`},{icon:"ðŸ”ï¸",text:`${m.toLocaleString()}m of climbing â€” ${(m/8849*100).toFixed(1)}% of Everest from sea level`},{icon:"â±ï¸",text:`At average walking pace, that's ~${Math.round(n/5)} hours on your feet`},{icon:"ðŸ‘Ÿ",text:`At ~${u}kg, your legs have moved approximately ${Math.round(n*u).toLocaleString()}kgÂ·km of bodyweight`}],v=new Date().getFullYear(),F=a.filter(e=>e.date&&new Date(e.date).getFullYear()===v),f=F.length>0,p=f?F:a,x=p.reduce((e,t)=>e+(t.distance||0)*(t.completions||1),0),w=p.reduce((e,t)=>e+(t.elevation||0)*(t.completions||1),0),$=p.reduce((e,t)=>e+(t.completions||1),0),k=v-1,d=a.filter(e=>e.date&&new Date(e.date).getFullYear()===k),O=d.reduce((e,t)=>e+(t.distance||0)*(t.completions||1),0),R=d.reduce((e,t)=>e+(t.elevation||0)*(t.completions||1),0),T=d.reduce((e,t)=>e+(t.completions||1),0),q={current:{year:v,distance:x,elevation:w,events:$},previous:{year:k,distance:O,elevation:R,events:T},hasData:f||d.length>0},z=a.filter(e=>e.date&&e.difficulty).sort((e,t)=>e.date.localeCompare(t.date)).map(e=>({name:e.name.length>14?e.name.slice(0,12)+"â€¦":e.name,difficulty:e.difficulty,date:e.date}));return{totalDistance:n,totalEvents:P,totalElevation:m,highestPeak:h,highestPeakEvent:b,distanceData:C,cumulativeData:Y,typeBreakdown:M,personalRecords:B,funFacts:j,yearStats:{yearDistance:x,yearElevation:w,yearEvents:$,hasYearDates:f},yoyComparison:q,difficultyProgression:z,prTimeline:r}},[a,u])}export{V as u};
