import{u as g,r as c,j as e}from"./index-DRgCCeWg.js";import{F as j,p as f}from"./gpxParser-C4hjP2j0.js";import{U as y}from"./upload-CYvd0jzl.js";import{M as N}from"./map-BC8oWSgZ.js";import{T as b}from"./trending-up-B45m5DyR.js";import{T as v}from"./trash-2-cRdwVEoc.js";function T(){const{state:d,dispatch:x}=g(),a=d.preferences?.routes??[],[n,l]=c.useState(null),i=c.useRef(null),o=s=>x({type:"UPDATE_PREFERENCES",payload:{routes:s}}),m=s=>{if(!s)return;l(null);const r=new FileReader;r.onload=u=>{try{const t=f(u.target.result),h={id:Date.now().toString(36),name:s.name.replace(/\.gpx$/i,""),distance:Math.round(t.distance*10)/10,elevationGain:Math.round(t.elevationGain),pointCount:t.trackPoints.length,addedAt:new Date().toISOString()};o([...a,h])}catch(t){l(t.message||"Failed to parse GPX")}},r.readAsText(s)},p=s=>{o(a.filter(r=>r.id!==s))};return e.jsxs("div",{className:"px-4 pb-24 sm:pb-8 pt-4 space-y-5",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-white mb-1",children:"Route Library"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Save and reuse GPX routes across events"})]}),e.jsxs("button",{onClick:()=>i.current?.click(),className:"w-full rounded-2xl border-2 border-dashed border-gray-700/50 p-6 flex flex-col items-center gap-2 bg-gray-800/30 hover:border-gray-500 transition-colors cursor-pointer",children:[e.jsx(y,{size:24,className:"text-gray-500"}),e.jsxs("span",{className:"text-sm text-gray-400",children:["Upload a ",e.jsx("span",{className:"text-gray-300 font-medium",children:".gpx"})," file to your library"]})]}),e.jsx("input",{ref:i,type:"file",accept:".gpx",onChange:s=>{m(s.target.files?.[0]),s.target.value=""},className:"hidden"}),n&&e.jsx("p",{className:"text-sm text-red-400",children:n}),a.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(N,{size:40,className:"text-gray-700 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"No routes saved yet"}),e.jsx("p",{className:"text-gray-600 text-xs mt-1",children:"Upload GPX files to build your library"})]}):e.jsx("div",{className:"space-y-3",children:a.map(s=>e.jsx("div",{className:"bg-gray-800/60 rounded-2xl p-4 border border-gray-700/50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(j,{size:20,className:"text-indigo-400 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-white font-bold text-sm truncate",children:s.name}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[e.jsxs("span",{className:"text-emerald-400 text-xs font-bold",children:[s.distance,"km"]}),e.jsxs("span",{className:"flex items-center gap-1 text-orange-400 text-xs",children:[e.jsx(b,{size:12})," ",s.elevationGain,"m"]}),e.jsxs("span",{className:"text-gray-600 text-xs",children:[s.pointCount," pts"]})]})]}),e.jsx("button",{onClick:()=>p(s.id),className:"text-gray-600 hover:text-red-400 transition-colors p-1",children:e.jsx(v,{size:16})})]})},s.id))})]})}export{T as default};
