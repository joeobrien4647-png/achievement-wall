import{j as e,G as f,B as k,r as y,e as E,E as S,T as m}from"./index-ClocMNDQ.js";import{u as P}from"./useEvents-DO3zeIMH.js";import{C as T,c as D,a as $,S as z}from"./photos-C5O7klfT.js";import{X as N}from"./x-zsNgVwDR.js";import{P as I}from"./plus-CFBI2qCH.js";function Y({value:n,onChange:c}){return e.jsx("div",{className:"grid grid-cols-4 gap-2",children:f.map(l=>e.jsx("button",{type:"button",onClick:()=>c(l),className:`h-12 rounded-xl border-2 transition-all ${n===l?"border-white scale-105 shadow-lg":"border-gray-700 hover:border-gray-500"}`,style:{background:l}},l))})}function F({value:n,onChange:c}){return e.jsx("div",{className:"grid grid-cols-5 gap-2",children:k.map(l=>e.jsx("button",{type:"button",onClick:()=>c(l),className:`text-2xl h-11 rounded-xl border-2 transition-all flex items-center justify-center ${n===l?"border-white bg-gray-700 scale-105":"border-gray-700 bg-gray-800 hover:border-gray-500"}`,children:l},l))})}function r({label:n,children:c}){return e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] uppercase tracking-widest text-gray-400 font-bold mb-1.5 block",children:n}),c]})}function O({value:n,onChange:c}){return e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(l=>e.jsx("button",{type:"button",onClick:()=>c(l),className:"p-1",children:e.jsx(z,{size:24,className:`transition-colors ${l<=n?"text-amber-400 fill-amber-400":"text-gray-600"}`})},l))})}function b({tags:n,onChange:c,placeholder:l}){const[h,p]=y.useState(""),x=()=>{const i=h.trim();i&&!n.includes(i)&&c([...n,i]),p("")};return e.jsxs("div",{children:[e.jsx("div",{className:"flex gap-2 flex-wrap mb-2",children:n.map((i,a)=>e.jsxs("span",{className:"bg-indigo-500/10 text-indigo-300 text-xs font-medium px-2.5 py-1 rounded-lg border border-indigo-500/20 flex items-center gap-1.5",children:[i,e.jsx("button",{type:"button",onClick:()=>c(n.filter((j,g)=>g!==a)),children:e.jsx(N,{size:12})})]},a))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:h,onChange:i=>p(i.target.value),onKeyDown:i=>i.key==="Enter"&&(i.preventDefault(),x()),placeholder:l,className:"flex-1 bg-gray-800 border border-gray-700 rounded-xl px-3 py-2 text-sm text-white placeholder:text-gray-500 focus:outline-none focus:border-indigo-500"}),e.jsx("button",{type:"button",onClick:x,className:"bg-gray-800 border border-gray-700 rounded-xl px-3 hover:border-gray-500 transition-colors",children:e.jsx(I,{size:16,className:"text-gray-400"})})]})]})}function B({eventId:n,onBack:c}){const{getEventById:l,addEvent:h,updateEvent:p}=P(),x=n?l(n):null,i=!!x,[a,j]=y.useState(()=>{if(x)return{...x};let t={};try{const o=sessionStorage.getItem("formPrefill");o&&(t=JSON.parse(o))}catch{}return{...E(),name:"",type:"Mountain",status:"completed",distance:"",elevation:"",location:"",date:"",time:"",difficulty:3,peaks:[],story:"",lessons:"",badge:"ðŸ”ï¸",heroImage:f[0],completions:1,phase:"",week:"",progress:0,route:"",reasons:[],watchOuts:[],...t}}),[g,v]=y.useState([]),s=(t,o)=>j(u=>({...u,[t]:o})),C=t=>{if(t.preventDefault(),!a.name?.trim()){v(["Name is required"]);return}const o={...a,distance:a.distance?Number(a.distance):null,elevation:a.elevation?Number(a.elevation):null,date:a.date||null,time:a.time||null,completions:Math.max(1,Number(a.completions)||1),color:m[a.type]||"#8b5cf6"};if(i)p(n,o);else{const u=h(o);if(!u.success){v(u.errors);return}}c()},d="w-full bg-gray-800 border border-gray-700 rounded-xl px-3 py-2.5 text-sm text-white placeholder:text-gray-500 focus:outline-none focus:border-indigo-500 transition-colors";return e.jsxs("div",{className:"pb-24 sm:pb-8",children:[e.jsxs("div",{className:"h-32 flex items-center justify-center text-5xl relative",style:{background:a.heroImage},children:[e.jsx("button",{onClick:c,className:"absolute top-4 left-4 bg-black/40 backdrop-blur rounded-full p-2 text-white hover:bg-black/60",children:e.jsx(T,{size:18})}),e.jsx("span",{children:a.badge})]}),e.jsx("div",{className:"px-4 -mt-4 relative",children:e.jsxs("form",{onSubmit:C,className:"bg-gray-900 rounded-2xl border border-gray-800 overflow-hidden",children:[e.jsxs("div",{className:"p-5 space-y-5",children:[e.jsx("h2",{className:"text-xl font-black text-white",children:i?"Edit Event":"New Event"}),g.length>0&&e.jsx("div",{className:"bg-red-900/30 border border-red-700/40 rounded-xl p-3",children:g.map((t,o)=>e.jsx("p",{className:"text-red-300 text-sm",children:t},o))}),e.jsx(r,{label:"Event Name",children:e.jsx("input",{type:"text",value:a.name,onChange:t=>s("name",t.target.value),placeholder:"Yorkshire 3 Peaks",className:d,maxLength:80})}),e.jsx(r,{label:"Type",children:e.jsx("div",{className:"flex gap-2",children:S.map(t=>e.jsx("button",{type:"button",onClick:()=>s("type",t),className:`flex-1 py-2 rounded-xl text-sm font-bold transition-all ${a.type===t?"text-white border-2":"text-gray-400 bg-gray-800 border-2 border-gray-700 hover:border-gray-500"}`,style:a.type===t?{backgroundColor:m[t]+"30",borderColor:m[t]}:{},children:t},t))})}),e.jsx(r,{label:"Status",children:e.jsx("div",{className:"flex gap-2",children:["completed","upcoming","wishlist"].map(t=>e.jsx("button",{type:"button",onClick:()=>s("status",t),className:`flex-1 py-2 rounded-xl text-sm font-medium capitalize transition-all border-2 ${a.status===t?"bg-indigo-500/20 border-indigo-500 text-white":"bg-gray-800 border-gray-700 text-gray-400 hover:border-gray-500"}`,children:t},t))})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(r,{label:"Distance (km)",children:e.jsx("input",{type:"number",value:a.distance,onChange:t=>s("distance",t.target.value),placeholder:"38",className:d,min:"0",step:"0.1"})}),e.jsx(r,{label:"Elevation (m)",children:e.jsx("input",{type:"number",value:a.elevation,onChange:t=>s("elevation",t.target.value),placeholder:"1585",className:d,min:"0"})})]}),e.jsx(r,{label:"Location",children:e.jsx("input",{type:"text",value:a.location,onChange:t=>s("location",t.target.value),placeholder:"Yorkshire Dales",className:d})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(r,{label:"Date",children:e.jsx("input",{type:"date",value:a.date||"",onChange:t=>s("date",t.target.value),className:d})}),a.status==="completed"&&e.jsx(r,{label:"Finish Time (HH:MM:SS)",children:e.jsx("input",{type:"text",value:a.time||"",onChange:t=>s("time",t.target.value),placeholder:"12:34:56",className:d})})]}),e.jsx(r,{label:"Difficulty",children:e.jsx(O,{value:a.difficulty,onChange:t=>s("difficulty",t)})}),a.status==="completed"&&e.jsx(r,{label:"Completions",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{type:"button",onClick:()=>s("completions",Math.max(1,(a.completions||1)-1)),className:"w-10 h-10 rounded-xl bg-gray-800 border border-gray-700 text-white font-bold text-lg hover:border-gray-500",children:"âˆ’"}),e.jsx("span",{className:"text-white font-bold text-xl w-8 text-center",children:a.completions||1}),e.jsx("button",{type:"button",onClick:()=>s("completions",(a.completions||1)+1),className:"w-10 h-10 rounded-xl bg-gray-800 border border-gray-700 text-white font-bold text-lg hover:border-gray-500",children:"+"})]})}),e.jsx(r,{label:"Peaks Summited",children:e.jsx(b,{tags:a.peaks||[],onChange:t=>s("peaks",t),placeholder:"Pen-y-ghent (694m)"})}),e.jsx(r,{label:"The Story",children:e.jsx("textarea",{value:a.story,onChange:t=>s("story",t.target.value),placeholder:"Tell the story of this event...",className:`${d} min-h-[100px] resize-y`})}),e.jsx(r,{label:"Lessons Learned",children:e.jsx("textarea",{value:a.lessons,onChange:t=>s("lessons",t.target.value),placeholder:"What did you learn?",className:`${d} min-h-[80px] resize-y`})}),e.jsx(r,{label:`Photos${(a.photos?.length||0)>0?` (${a.photos.length}/5)`:""}`,children:e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[(a.photos||[]).map((t,o)=>e.jsxs("div",{className:"aspect-square rounded-xl overflow-hidden relative group",children:[e.jsx("img",{src:t,alt:"",className:"w-full h-full object-cover"}),e.jsx("button",{type:"button",onClick:()=>s("photos",a.photos.filter((u,w)=>w!==o)),className:"absolute top-1 right-1 bg-black/60 rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity text-white",children:e.jsx(N,{size:12})})]},o)),(a.photos?.length||0)<5&&e.jsxs("label",{className:"aspect-square bg-gray-800 rounded-xl border-2 border-dashed border-gray-700 flex items-center justify-center cursor-pointer hover:border-gray-500 transition-colors",children:[e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:async t=>{const o=t.target.files?.[0];if(o){try{const u=await D(o);s("photos",[...a.photos||[],u])}catch{}t.target.value=""}}}),e.jsxs("div",{className:"text-center",children:[e.jsx($,{size:18,className:"text-gray-600 mx-auto"}),e.jsx("span",{className:"text-[10px] text-gray-600 mt-1 block",children:"Add"})]})]})]})}),a.status==="upcoming"&&e.jsxs(e.Fragment,{children:[e.jsx(r,{label:"Route Description",children:e.jsx("textarea",{value:a.route||"",onChange:t=>s("route",t.target.value),placeholder:"Describe the route...",className:`${d} min-h-[80px] resize-y`})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(r,{label:"Training Phase",children:e.jsx("input",{type:"text",value:a.phase||"",onChange:t=>s("phase",t.target.value),placeholder:"Build Phase",className:d})}),e.jsx(r,{label:"Current Week",children:e.jsx("input",{type:"text",value:a.week||"",onChange:t=>s("week",t.target.value),placeholder:"Week 1 of 12",className:d})})]}),e.jsx(r,{label:`Training Progress (${a.progress||0}%)`,children:e.jsx("input",{type:"range",min:"0",max:"100",value:a.progress||0,onChange:t=>s("progress",Number(t.target.value)),className:"w-full accent-red-500"})}),e.jsx(r,{label:"Why You'll Finish",children:e.jsx(b,{tags:a.reasons||[],onChange:t=>s("reasons",t),placeholder:"Add a reason..."})}),e.jsx(r,{label:"Watch-Outs",children:e.jsx(b,{tags:a.watchOuts||[],onChange:t=>s("watchOuts",t),placeholder:"Add a watch-out..."})})]}),a.status==="wishlist"&&e.jsxs(e.Fragment,{children:[e.jsx(r,{label:"Why does this appeal to you?",children:e.jsx("textarea",{value:a.appeal||"",onChange:t=>s("appeal",t.target.value),placeholder:"What draws you to this challenge...",className:`${d} min-h-[80px] resize-y`})}),e.jsx(r,{label:"Target Year",children:e.jsx("input",{type:"number",value:a.targetYear||"",onChange:t=>s("targetYear",t.target.value?Number(t.target.value):null),placeholder:`${new Date().getFullYear()+1}`,className:d,min:"2024",max:"2040"})})]}),e.jsx(r,{label:"Badge",children:e.jsx(F,{value:a.badge,onChange:t=>s("badge",t)})}),e.jsx(r,{label:"Banner Gradient",children:e.jsx(Y,{value:a.heroImage,onChange:t=>s("heroImage",t)})})]}),e.jsx("div",{className:"border-t border-gray-800 p-5",children:e.jsx("button",{type:"submit",className:"w-full py-3 rounded-xl bg-indigo-600 text-white font-bold text-sm hover:bg-indigo-500 transition-colors active:scale-[0.98]",children:i?"Save Changes":"Add Event"})})]})})]})}export{B as default};
