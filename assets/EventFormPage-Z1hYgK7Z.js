import{c as S,j as e,G as T,B as L,r as p,f as $,E as z,a as j}from"./index-CSeORV3c.js";import{u as I}from"./useEvents-DgMYE35U.js";import{C as M,c as W,a as _,S as D}from"./photos-BIrrJKQn.js";import{C as A}from"./check-NdbXj6C7.js";import{X as N}from"./x-DeWaJnrZ.js";import{P as O}from"./plus-BPztX3p-.js";import{C as G}from"./chevron-down-BYdSK9n3.js";const Y=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],P=S("package",Y);const R=[["path",{d:"M18 7c0-5.333-8-5.333-8 0",key:"1prm2n"}],["path",{d:"M10 7v14",key:"18tmcs"}],["path",{d:"M6 21h12",key:"4dkmi1"}],["path",{d:"M6 13h10",key:"ybwr4a"}]],B=S("pound-sterling",R);function q({value:l,onChange:i}){return e.jsx("div",{className:"grid grid-cols-4 gap-2",children:T.map(c=>e.jsx("button",{type:"button",onClick:()=>i(c),className:`h-12 rounded-xl border-2 transition-all ${l===c?"border-white scale-105 shadow-lg":"border-gray-700 hover:border-gray-500"}`,style:{background:c}},c))})}function H({value:l,onChange:i}){return e.jsx("div",{className:"grid grid-cols-5 gap-2",children:L.map(c=>e.jsx("button",{type:"button",onClick:()=>i(c),className:`text-2xl h-11 rounded-xl border-2 transition-all flex items-center justify-center ${l===c?"border-white bg-gray-700 scale-105":"border-gray-700 bg-gray-800 hover:border-gray-500"}`,children:c},c))})}const k=["Clothing","Footwear","Navigation","Food & Water","Safety","Other"],C={Clothing:"ðŸ‘•",Footwear:"ðŸ¥¾",Navigation:"ðŸ§­","Food & Water":"ðŸ¥¤",Safety:"ðŸ›¡ï¸",Other:"ðŸ“¦"},w={Mountain:[{name:"Waterproofs",category:"Clothing",checked:!1},{name:"Warm layers",category:"Clothing",checked:!1},{name:"Gaiters",category:"Footwear",checked:!1},{name:"Trekking poles",category:"Other",checked:!1},{name:"Map",category:"Navigation",checked:!1},{name:"Compass",category:"Navigation",checked:!1},{name:"Headtorch",category:"Navigation",checked:!1},{name:"First aid kit",category:"Safety",checked:!1},{name:"Whistle",category:"Safety",checked:!1},{name:"Emergency shelter",category:"Safety",checked:!1}],Ultra:[{name:"Headtorch",category:"Navigation",checked:!1},{name:"Spare batteries",category:"Navigation",checked:!1},{name:"Blister kit",category:"Safety",checked:!1},{name:"Emergency blanket",category:"Safety",checked:!1},{name:"Energy gels",category:"Food & Water",checked:!1},{name:"Electrolytes",category:"Food & Water",checked:!1},{name:"Phone charger",category:"Other",checked:!1},{name:"Change of socks",category:"Footwear",checked:!1}],Urban:[{name:"Phone",category:"Navigation",checked:!1},{name:"Portable charger",category:"Other",checked:!1},{name:"Snacks",category:"Food & Water",checked:!1},{name:"Water bottle",category:"Food & Water",checked:!1},{name:"Rain jacket",category:"Clothing",checked:!1},{name:"Comfortable shoes",category:"Footwear",checked:!1},{name:"Cash",category:"Other",checked:!1}]};function K({items:l=[],onChange:i,eventType:c="Mountain"}){const[m,g]=p.useState(""),[x,d]=p.useState("Other"),a=()=>{const s=m.trim();!s||l.some(r=>r.name.toLowerCase()===s.toLowerCase())||(i([...l,{name:s,category:x,checked:!1}]),g(""))},y=s=>{i(l.filter((t,r)=>r!==s))},u=s=>{i(l.map((t,r)=>r===s?{...t,checked:!t.checked}:t))},b=()=>{const s=w[c]||w.Mountain,t=new Set(l.map(h=>h.name.toLowerCase())),r=s.filter(h=>!t.has(h.name.toLowerCase()));i([...l,...r])},o=k.map(s=>({category:s,items:l.map((t,r)=>({...t,_index:r})).filter(t=>t.category===s)})).filter(s=>s.items.length>0),f=l.filter(s=>s.checked).length;return e.jsxs("div",{className:"space-y-3",children:[l.length>0&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-gray-400",children:[f,"/",l.length," packed"]}),e.jsx("div",{className:"flex-1 mx-3 h-1.5 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-emerald-500 rounded-full transition-all duration-300",style:{width:`${l.length>0?f/l.length*100:0}%`}})})]}),o.map(({category:s,items:t})=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-1.5",children:[e.jsx("span",{className:"text-sm",children:C[s]}),e.jsx("span",{className:"text-[10px] uppercase tracking-widest text-gray-500 font-bold",children:s})]}),e.jsx("div",{className:"space-y-1",children:t.map(r=>e.jsxs("div",{className:"flex items-center gap-2 group",children:[e.jsx("button",{type:"button",onClick:()=>u(r._index),className:`w-5 h-5 rounded-md border flex-shrink-0 flex items-center justify-center transition-all ${r.checked?"bg-emerald-500 border-emerald-500":"border-gray-600 hover:border-gray-400"}`,children:r.checked&&e.jsx(A,{size:12,className:"text-white"})}),e.jsx("span",{className:`text-sm flex-1 transition-colors ${r.checked?"text-gray-500 line-through":"text-gray-200"}`,children:r.name}),e.jsx("button",{type:"button",onClick:()=>y(r._index),className:"opacity-0 group-hover:opacity-100 text-gray-600 hover:text-red-400 transition-all p-0.5",children:e.jsx(N,{size:14})})]},r._index))})]},s)),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:m,onChange:s=>g(s.target.value),onKeyDown:s=>s.key==="Enter"&&(s.preventDefault(),a()),placeholder:"Add item...",className:"flex-1 bg-gray-800 border border-gray-700 rounded-xl px-3 py-2 text-sm text-white placeholder:text-gray-500 focus:outline-none focus:border-indigo-500"}),e.jsx("select",{value:x,onChange:s=>d(s.target.value),className:"bg-gray-800 border border-gray-700 rounded-xl px-2 py-2 text-sm text-gray-300 focus:outline-none focus:border-indigo-500 appearance-none cursor-pointer",children:k.map(s=>e.jsxs("option",{value:s,children:[C[s]," ",s]},s))}),e.jsx("button",{type:"button",onClick:a,className:"bg-gray-800 border border-gray-700 rounded-xl px-3 hover:border-gray-500 transition-colors",children:e.jsx(O,{size:16,className:"text-gray-400"})})]}),e.jsxs("button",{type:"button",onClick:b,className:"flex items-center gap-2 text-xs text-indigo-400 hover:text-indigo-300 font-medium transition-colors",children:[e.jsx(P,{size:14}),"Load ",c," template"]})]})}const U=[{key:"entry",label:"Entry",color:"#6366f1"},{key:"travel",label:"Travel",color:"#10b981"},{key:"accommodation",label:"Accomm.",color:"#f59e0b"},{key:"gear",label:"Gear",color:"#f43f5e"},{key:"food",label:"Food",color:"#f97316"},{key:"other",label:"Other",color:"#6b7280"}];function n({label:l,children:i}){return e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] uppercase tracking-widest text-gray-400 font-bold mb-1.5 block",children:l}),i]})}function V({value:l,onChange:i}){return e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(c=>e.jsx("button",{type:"button",onClick:()=>i(c),className:"p-1",children:e.jsx(D,{size:24,className:`transition-colors ${c<=l?"text-amber-400 fill-amber-400":"text-gray-600"}`})},c))})}function v({tags:l,onChange:i,placeholder:c}){const[m,g]=p.useState(""),x=()=>{const d=m.trim();d&&!l.includes(d)&&i([...l,d]),g("")};return e.jsxs("div",{children:[e.jsx("div",{className:"flex gap-2 flex-wrap mb-2",children:l.map((d,a)=>e.jsxs("span",{className:"bg-indigo-500/10 text-indigo-300 text-xs font-medium px-2.5 py-1 rounded-lg border border-indigo-500/20 flex items-center gap-1.5",children:[d,e.jsx("button",{type:"button",onClick:()=>i(l.filter((y,u)=>u!==a)),children:e.jsx(N,{size:12})})]},a))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:m,onChange:d=>g(d.target.value),onKeyDown:d=>d.key==="Enter"&&(d.preventDefault(),x()),placeholder:c,className:"flex-1 bg-gray-800 border border-gray-700 rounded-xl px-3 py-2 text-sm text-white placeholder:text-gray-500 focus:outline-none focus:border-indigo-500"}),e.jsx("button",{type:"button",onClick:x,className:"bg-gray-800 border border-gray-700 rounded-xl px-3 hover:border-gray-500 transition-colors",children:e.jsx(O,{size:16,className:"text-gray-400"})})]})]})}function E({icon:l,title:i,children:c,defaultOpen:m=!1}){const[g,x]=p.useState(m);return e.jsxs("div",{className:"border border-gray-700/50 rounded-xl overflow-hidden",children:[e.jsxs("button",{type:"button",onClick:()=>x(d=>!d),className:"w-full flex items-center gap-2.5 px-3.5 py-3 bg-gray-800/40 hover:bg-gray-800/70 transition-colors",children:[l&&e.jsx(l,{size:16,className:"text-gray-400"}),e.jsx("span",{className:"text-sm font-bold text-white flex-1 text-left",children:i}),e.jsx(G,{size:16,className:`text-gray-500 transition-transform duration-200 ${g?"rotate-180":""}`})]}),g&&e.jsx("div",{className:"px-3.5 py-3 border-t border-gray-700/50",children:c})]})}function se({eventId:l,onBack:i}){const{getEventById:c,addEvent:m,updateEvent:g}=I(),x=l?c(l):null,d=!!x,[a,y]=p.useState(()=>{if(x)return{...x};let t={};try{const r=sessionStorage.getItem("formPrefill");r&&(t=JSON.parse(r))}catch{}return{...$(),name:"",type:"Mountain",status:"completed",distance:"",elevation:"",location:"",date:"",time:"",difficulty:3,peaks:[],story:"",lessons:"",badge:"ðŸ”ï¸",heroImage:T[0],completions:1,phase:"",week:"",progress:0,route:"",reasons:[],watchOuts:[],...t}}),[u,b]=p.useState([]),o=(t,r)=>y(h=>({...h,[t]:r})),f=t=>{if(t.preventDefault(),!a.name?.trim()){b(["Name is required"]);return}const r={...a,distance:a.distance?Number(a.distance):null,elevation:a.elevation?Number(a.elevation):null,date:a.date||null,time:a.time||null,completions:Math.max(1,Number(a.completions)||1),color:j[a.type]||"#8b5cf6"};if(d)g(l,r);else{const h=m(r);if(!h.success){b(h.errors);return}}i()},s="w-full bg-gray-800 border border-gray-700 rounded-xl px-3 py-2.5 text-sm text-white placeholder:text-gray-500 focus:outline-none focus:border-indigo-500 transition-colors";return e.jsxs("div",{className:"pb-24 sm:pb-8",children:[e.jsxs("div",{className:"h-32 flex items-center justify-center text-5xl relative",style:{background:a.heroImage},children:[e.jsx("button",{onClick:i,className:"absolute top-4 left-4 bg-black/40 backdrop-blur rounded-full p-2 text-white hover:bg-black/60",children:e.jsx(M,{size:18})}),e.jsx("span",{children:a.badge})]}),e.jsx("div",{className:"px-4 -mt-4 relative",children:e.jsxs("form",{onSubmit:f,className:"bg-gray-900 rounded-2xl border border-gray-800 overflow-hidden",children:[e.jsxs("div",{className:"p-5 space-y-5",children:[e.jsx("h2",{className:"text-xl font-black text-white",children:d?"Edit Event":"New Event"}),u.length>0&&e.jsx("div",{className:"bg-red-900/30 border border-red-700/40 rounded-xl p-3",children:u.map((t,r)=>e.jsx("p",{className:"text-red-300 text-sm",children:t},r))}),e.jsx(n,{label:"Event Name",children:e.jsx("input",{type:"text",value:a.name,onChange:t=>o("name",t.target.value),placeholder:"Yorkshire 3 Peaks",className:s,maxLength:80})}),e.jsx(n,{label:"Type",children:e.jsx("div",{className:"flex gap-2",children:z.map(t=>e.jsx("button",{type:"button",onClick:()=>o("type",t),className:`flex-1 py-2 rounded-xl text-sm font-bold transition-all ${a.type===t?"text-white border-2":"text-gray-400 bg-gray-800 border-2 border-gray-700 hover:border-gray-500"}`,style:a.type===t?{backgroundColor:j[t]+"30",borderColor:j[t]}:{},children:t},t))})}),e.jsx(n,{label:"Status",children:e.jsx("div",{className:"flex gap-2",children:["completed","upcoming","wishlist"].map(t=>e.jsx("button",{type:"button",onClick:()=>o("status",t),className:`flex-1 py-2 rounded-xl text-sm font-medium capitalize transition-all border-2 ${a.status===t?"bg-indigo-500/20 border-indigo-500 text-white":"bg-gray-800 border-gray-700 text-gray-400 hover:border-gray-500"}`,children:t},t))})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(n,{label:"Distance (km)",children:e.jsx("input",{type:"number",value:a.distance,onChange:t=>o("distance",t.target.value),placeholder:"38",className:s,min:"0",step:"0.1"})}),e.jsx(n,{label:"Elevation (m)",children:e.jsx("input",{type:"number",value:a.elevation,onChange:t=>o("elevation",t.target.value),placeholder:"1585",className:s,min:"0"})})]}),e.jsx(n,{label:"Location",children:e.jsx("input",{type:"text",value:a.location,onChange:t=>o("location",t.target.value),placeholder:"Yorkshire Dales",className:s})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(n,{label:"Date",children:e.jsx("input",{type:"date",value:a.date||"",onChange:t=>o("date",t.target.value),className:s})}),a.status==="completed"&&e.jsx(n,{label:"Finish Time (HH:MM:SS)",children:e.jsx("input",{type:"text",value:a.time||"",onChange:t=>o("time",t.target.value),placeholder:"12:34:56",className:s})})]}),e.jsx(n,{label:"Difficulty",children:e.jsx(V,{value:a.difficulty,onChange:t=>o("difficulty",t)})}),a.status==="completed"&&e.jsx(n,{label:"Completions",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{type:"button",onClick:()=>o("completions",Math.max(1,(a.completions||1)-1)),className:"w-10 h-10 rounded-xl bg-gray-800 border border-gray-700 text-white font-bold text-lg hover:border-gray-500",children:"âˆ’"}),e.jsx("span",{className:"text-white font-bold text-xl w-8 text-center",children:a.completions||1}),e.jsx("button",{type:"button",onClick:()=>o("completions",(a.completions||1)+1),className:"w-10 h-10 rounded-xl bg-gray-800 border border-gray-700 text-white font-bold text-lg hover:border-gray-500",children:"+"})]})}),e.jsx(n,{label:"Peaks Summited",children:e.jsx(v,{tags:a.peaks||[],onChange:t=>o("peaks",t),placeholder:"Pen-y-ghent (694m)"})}),e.jsx(n,{label:"The Story",children:e.jsx("textarea",{value:a.story,onChange:t=>o("story",t.target.value),placeholder:"Tell the story of this event...",className:`${s} min-h-[100px] resize-y`})}),e.jsx(n,{label:"Lessons Learned",children:e.jsx("textarea",{value:a.lessons,onChange:t=>o("lessons",t.target.value),placeholder:"What did you learn?",className:`${s} min-h-[80px] resize-y`})}),e.jsx(n,{label:`Photos${(a.photos?.length||0)>0?` (${a.photos.length}/5)`:""}`,children:e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[(a.photos||[]).map((t,r)=>e.jsxs("div",{className:"aspect-square rounded-xl overflow-hidden relative group",children:[e.jsx("img",{src:t,alt:"",className:"w-full h-full object-cover"}),e.jsx("button",{type:"button",onClick:()=>o("photos",a.photos.filter((h,F)=>F!==r)),className:"absolute top-1 right-1 bg-black/60 rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity text-white",children:e.jsx(N,{size:12})})]},r)),(a.photos?.length||0)<5&&e.jsxs("label",{className:"aspect-square bg-gray-800 rounded-xl border-2 border-dashed border-gray-700 flex items-center justify-center cursor-pointer hover:border-gray-500 transition-colors",children:[e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:async t=>{const r=t.target.files?.[0];if(r){try{const h=await W(r);o("photos",[...a.photos||[],h])}catch{}t.target.value=""}}}),e.jsxs("div",{className:"text-center",children:[e.jsx(_,{size:18,className:"text-gray-600 mx-auto"}),e.jsx("span",{className:"text-[10px] text-gray-600 mt-1 block",children:"Add"})]})]})]})}),e.jsx(E,{icon:P,title:`Kit List${(a.kitList?.length||0)>0?` (${a.kitList.length})`:""}`,children:e.jsx(K,{items:a.kitList||[],onChange:t=>o("kitList",t),eventType:a.type})}),e.jsxs(E,{icon:B,title:"Costs",children:[e.jsx("div",{className:"grid grid-cols-2 gap-3",children:U.map(t=>e.jsx(n,{label:t.label,children:e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm",children:"Â£"}),e.jsx("input",{type:"number",value:a.costs?.[t.key]||"",onChange:r=>o("costs",{...a.costs||{},[t.key]:r.target.value===""?0:Number(r.target.value)}),placeholder:"0",className:s+" pl-7",min:"0",step:"0.01"})]})},t.key))}),(()=>{const t=Object.values(a.costs||{}).reduce((r,h)=>r+(Number(h)||0),0);return t>0?e.jsxs("div",{className:"mt-3 flex items-center justify-between pt-3 border-t border-gray-700/50",children:[e.jsx("span",{className:"text-xs text-gray-400 font-bold uppercase tracking-wider",children:"Total"}),e.jsxs("span",{className:"text-white font-black text-lg",children:["Â£",t.toLocaleString()]})]}):null})()]}),a.status==="upcoming"&&e.jsxs(e.Fragment,{children:[e.jsx(n,{label:"Route Description",children:e.jsx("textarea",{value:a.route||"",onChange:t=>o("route",t.target.value),placeholder:"Describe the route...",className:`${s} min-h-[80px] resize-y`})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(n,{label:"Training Phase",children:e.jsx("input",{type:"text",value:a.phase||"",onChange:t=>o("phase",t.target.value),placeholder:"Build Phase",className:s})}),e.jsx(n,{label:"Current Week",children:e.jsx("input",{type:"text",value:a.week||"",onChange:t=>o("week",t.target.value),placeholder:"Week 1 of 12",className:s})})]}),e.jsx(n,{label:`Training Progress (${a.progress||0}%)`,children:e.jsx("input",{type:"range",min:"0",max:"100",value:a.progress||0,onChange:t=>o("progress",Number(t.target.value)),className:"w-full accent-red-500"})}),e.jsx(n,{label:"Why You'll Finish",children:e.jsx(v,{tags:a.reasons||[],onChange:t=>o("reasons",t),placeholder:"Add a reason..."})}),e.jsx(n,{label:"Watch-Outs",children:e.jsx(v,{tags:a.watchOuts||[],onChange:t=>o("watchOuts",t),placeholder:"Add a watch-out..."})})]}),a.status==="wishlist"&&e.jsxs(e.Fragment,{children:[e.jsx(n,{label:"Why does this appeal to you?",children:e.jsx("textarea",{value:a.appeal||"",onChange:t=>o("appeal",t.target.value),placeholder:"What draws you to this challenge...",className:`${s} min-h-[80px] resize-y`})}),e.jsx(n,{label:"Target Year",children:e.jsx("input",{type:"number",value:a.targetYear||"",onChange:t=>o("targetYear",t.target.value?Number(t.target.value):null),placeholder:`${new Date().getFullYear()+1}`,className:s,min:"2024",max:"2040"})})]}),e.jsx(n,{label:"Badge",children:e.jsx(H,{value:a.badge,onChange:t=>o("badge",t)})}),e.jsx(n,{label:"Banner Gradient",children:e.jsx(q,{value:a.heroImage,onChange:t=>o("heroImage",t)})})]}),e.jsx("div",{className:"border-t border-gray-800 p-5",children:e.jsx("button",{type:"submit",className:"w-full py-3 rounded-xl bg-indigo-600 text-white font-bold text-sm hover:bg-indigo-500 transition-colors active:scale-[0.98]",children:d?"Save Changes":"Add Event"})})]})})]})}export{se as default};
