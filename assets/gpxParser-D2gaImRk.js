import{c as d}from"./index-BZJhhq9e.js";const M=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],I=d("file-text",M),y=6371;function p(r){return r*Math.PI/180}function m(r,l,o,a){const t=p(o-r),e=p(a-l),n=Math.sin(t/2)**2+Math.cos(p(r))*Math.cos(p(o))*Math.sin(e/2)**2;return y*2*Math.atan2(Math.sqrt(n),Math.sqrt(1-n))}function g(r){let l=r.querySelectorAll("trk > trkseg > trkpt");l.length===0&&(l=r.querySelectorAll("rte > rtept"));const o=[];for(const a of l){const t=parseFloat(a.getAttribute("lat")),e=parseFloat(a.getAttribute("lon"));if(isNaN(t)||isNaN(e))continue;const n=a.querySelector("ele"),c=n?parseFloat(n.textContent):null;o.push({lat:t,lon:e,ele:isNaN(c)?null:c})}return o}function k(r){let l=1/0,o=-1/0,a=1/0,t=-1/0;for(const{lat:e,lon:n}of r)e<l&&(l=e),e>o&&(o=e),n<a&&(a=n),n>t&&(t=n);return{minLat:l,maxLat:o,minLon:a,maxLon:t}}function x(r){const o=new DOMParser().parseFromString(r,"application/xml");if(o.querySelector("parsererror"))throw new Error("Invalid GPX: XML parsing failed");const t=g(o);if(t.length===0)throw new Error("Invalid GPX: no track or route points found");let e=0,n=0;const c=[];t[0].ele!=null&&c.push({dist:0,ele:t[0].ele});for(let u=1;u<t.length;u++){const i=t[u-1],s=t[u];e+=m(i.lat,i.lon,s.lat,s.lon),i.ele!=null&&s.ele!=null&&s.ele>i.ele&&(n+=s.ele-i.ele),s.ele!=null&&c.push({dist:e,ele:s.ele})}const f=Math.round(e*100)/100,h=Math.round(n);return{distance:f,elevationGain:h,elevationProfile:c,bounds:k(t),trackPoints:t.map(({lat:u,lon:i})=>({lat:u,lon:i}))}}export{I as F,x as p};
